["{\"nodes\":{\"ED_Digest_LoyaltyTierGroup\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"LoyaltyProgramId\"}],\"object\":\"LoyaltyTierGroup\"}},\"ED_Filter_LoyaltyProgramMember\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'Program.Name' == \\\"Partner Extra Program\\\" && 'MemberType' != \\\"Group\\\"\"},\"sources\":[\"ED_Augment_LoyaltyProgram_onto_LoyaltyProgramMember\"]},\"CX_CR_SurveyQuestionResponse\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"ResponseId\"},\"label\":\"FirstResponseValue\",\"name\":\"FirstResponseValue\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"SurveyResponse.CompletionDateTime\"}],\"partitionBy\":[\"QuesTypeResponseID\"]},\"sources\":[\"CX_CE_SurveyQuestionResponse_QuesTypeResponseId\"]},\"ED_Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramCurrencyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ProgramCurrency\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"ED_Digest_LoyaltyMemberCurrency\",\"ED_Digest_LoyaltyProgramCurrency\"]},\"ED_Augment_Account_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Account\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"BillingState\",\"BillingCity\"]},\"sources\":[\"ED_Digest_LoyaltyProgramMember\",\"ED_Digest_Account\"]},\"ED_CE_LoyaltyLedger_DeriveUpdatedPoints\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"PointsTemp\",\"name\":\"PointsTemp\",\"precision\":10,\"saqlExpression\":\"case when 'TransactionJournal.JournalType.Name' in [\\\"Accrual Reversal\\\", \\\"Manual Points Adjustment\\\"] and 'TransactionJournal.LoyaltyProgramMember.MemberType' != \\\"Group\\\" then  (coalesce('Points',0)+coalesce('GroupPoints.Points',0)) when 'TransactionJournal.JournalType.Name' in [\\\"Accrual Reversal\\\", \\\"Manual Points Adjustment\\\"] and 'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\"  then null else 'Points' end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"ED_Augment_Ledger_with_GroupMemberFinalRelatedJournal_onto_LoyaltyLedger\"]},\"ED_CE_LoyaltyLedger_DeriveFinalRelatedJournal\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"RelatedTransactionJournal\",\"name\":\"RelatedTransactionJournal\",\"saqlExpression\":\"case when 'TransactionJournal.JournalType.Name' == \\\"Accrual Reversal\\\" then 'RelatedTransactionJournal2.TransactionJournalId' when 'TransactionJournal.JournalType.Name' == \\\"Manual Points Adjustment\\\" then 'TransactionJournal.RelatedJournalId' else \\\"null\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"ED_Augment_Ledger_MemberRelatedJournal_onto_GroupMemberRelatedJournal\"]},\"CX_Filter_Survey_Latest_CSAT_Response_Scoring\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Latest_CSAT_Response_Flag == -99\"},\"sources\":[\"CX_CR_Survey_Latest_CSAT_Response_Flag_Scoring\"]},\"ED_Augment_Ledger_MemberRelatedJournal_onto_GroupMemberRelatedJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RelatedTransactionJournal1.TransactionJournal.RelatedJournalId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RelatedTransactionJournal2\",\"rightKey\":[\"TransactionJournal.RelatedJournalId\"],\"rightSelect\":[\"TransactionJournalId\"]},\"sources\":[\"ED_Augment_Ledger_GroupMember_RelatedJournal_onto_MemberJournal\",\"ED_Filter_LoyaltyLedger_get_NonGroupMember_AccrualReversals\"]},\"Dim2Mea_SurveyQuestionChoice_Convert_MaxValueStr_to_Number\":{\"action\":\"dim2mea\",\"parameters\":{\"dimension\":\"Name\",\"measure\":\"NumberValue\",\"measureDefault\":\"0\",\"measureType\":\"long\"},\"sources\":[\"CX_Append_SurveyQuestionChoice_w_RatingQuestion_with_Dummy\"]},\"ED_Augment_TransactionJournal_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"TransactionJournalId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"TransactionJournal\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Status\",\"JournalType.Name\",\"LoyaltyProgramMember.MemberType\",\"JournalType_Name\",\"RelatedJournalId\"]},\"sources\":[\"ED_Digest_LoyaltyLedger\",\"ED_CE_TransactionJournal\"]},\"ED_CE_TransactionJournal\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"JournalType_Name\",\"name\":\"JournalType_Name\",\"saqlExpression\":\"case when Status == \\\"Processed\\\" then\\ncase when 'LoyaltyProgramMember.MemberType' != \\\"Group\\\" then 'JournalType.Name' when 'LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'JournalType.Name' in [\\\"Redemption\\\", \\\"Redemption Reversal\\\"] then 'JournalType.Name' when 'LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'JournalType.Name' not in [\\\"Redemption\\\", \\\"Redemption Reversal\\\"] then 'JournalType.Name'+\\\"_Group\\\" end else 'JournalType.Name'+\\\"_\\\"+'Status' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"ED_Augment_LoyaltyProgramMember_onto_TransactionJournal\"]},\"CX_Augment_Survey_onto_SurveyVersion\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Survey\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"CX_Digest_SurveyVersion\",\"CX_Digest_Survey\"]},\"ED_Filter_LoyaltyMemberTier\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TierGroup.Id' is not null\"},\"sources\":[\"ED_Augment_LoyaltyTierGroup_onto_LoyaltyMemberTier\"]},\"CX_Filter_SurveyQuestionResponse_CSAT_Responses\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyQuestion.QuestionType' in [\\\"Rating\\\"]  && 'SurveyQuestion.Name' == \\\"How would you rate your overall satisfaction with your customer service experience today?\\\"\"},\"sources\":[\"CX_CE_SurveyQuestionResponse\"]},\"CX_Digest_SurveyQuestionResponse\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ChoiceValue\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"Datatype\"},{\"name\":\"DateTimeValue\"},{\"name\":\"DateValue\"},{\"name\":\"Id\"},{\"name\":\"InvitationId\"},{\"name\":\"IsDeleted\"},{\"name\":\"IsTrueOrFalse\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"NumberValue\"},{\"name\":\"QuestionChoiceId\"},{\"name\":\"QuestionId\"},{\"name\":\"Rank\"},{\"name\":\"ResponseId\"},{\"name\":\"ResponseShortText\"},{\"name\":\"ResponseValue\"},{\"name\":\"SurveyVersionId\"},{\"name\":\"SystemModstamp\"}],\"object\":\"SurveyQuestionResponse\"}},\"ED_MultiValue_Augment_LoyaltyProgramMember_onto_self_for_Referrals\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Referred\",\"rightKey\":[\"ReferredById\"],\"rightSelect\":[\"Member_Count\"]},\"sources\":[\"ED_CE_LoyaltyProgramMember\",\"ED_CE_LoyaltyProgramMember\"]},\"CX_ED_Augment_overall_NPS_Survey_Scoring_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Overall_NPS_Scoring\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"NPS_Response_Number\",\"Count\"]},\"sources\":[\"CX_ED_Augment_latest_NPS_Survey_onto_LoyaltyProgramMember\",\"CX_Filter_Current_SurveyResponses_Scoring\"]},\"ED_Augment_LoyaltyMemberCurrency_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"MemberCurrency\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"Name\",\"Ledger.Current_Accrued_Points\",\"Ledger.Previous_Accrued_Points\",\"Ledger.Current_Redeemed_Points\",\"Ledger.Previous_Redeemed_Points\",\"Ledger.Current_Expired_Points\",\"Ledger.Previous_Expired_Points\",\"Ledger.Current_Accrued_Points_Scoring\",\"Ledger.Previous_Accrued_Points_Scoring\",\"Ledger.Current_Redeemed_Points_Scoring\",\"Ledger.Previous_Redeemed_Points_Scoring\",\"Ledger.Current_Expired_Points_Scoring\",\"Ledger.Previous_Expired_Points_Scoring\",\"PointsBalance\"]},\"sources\":[\"ED_SingleValue_Augment_Transactions_onto_Members\",\"ED_Augment_LoyaltyLedger_onto_LoyaltyMemberCurrency\"]},\"CX_Augment_SurveyResponse_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ResponseId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyResponse\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CompletionDateTime\",\"Name\",\"Status\"]},\"sources\":[\"CX_Filter_SurveyQuestionResponse\",\"CX_Digest_SurveyResponse\"]},\"ED_Register_Members\":{\"action\":\"register\",\"parameters\":{\"label\":\"ED_Members_Activity\",\"name\":\"ED_Members_Activity\"},\"sources\":[\"ED_Filter_Training_Data\"]},\"ED_Augment_LoyaltyMemberTier_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\",\"ProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"MemberTier\",\"rightKey\":[\"LoyaltyMemberId\",\"TierGroup.LoyaltyProgramId\"],\"rightSelect\":[\"CreatedDate\",\"EffectiveDate\",\"Id\",\"LoyaltyTierGroupId\",\"LoyaltyMemberId\",\"LoyaltyTierId\",\"Name\",\"TierExpirationDate\",\"TierGroup.LoyaltyProgramId\",\"TierGroup.Id\",\"TierGroup.Name\",\"TierGroup.Program.Name\",\"TierGroup.Program.Id\",\"TierGroup.Program.OwnerId\",\"TierGroup.Program.Status\",\"TierGroup.SelectedTierGroup_Flag\"]},\"sources\":[\"ED_Filter_LoyaltyProgramMember\",\"ED_Filter_LoyaltyMemberTier\"]},\"ED_Append_Training_and_Scoring_data\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":false},\"sources\":[\"ED_Update_Columns_for_Scoring\",\"ED_Slice_Scoring_Columns\"]},\"CX_CR_SurveyQuestionChoice1\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"Name\"},\"label\":\"MaxValueString\",\"name\":\"MaxValueString\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"NumberValue\"},\"label\":\"MaxValue\",\"name\":\"MaxValue\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"NumberValue\"}],\"partitionBy\":[\"QuestionId\"]},\"sources\":[\"Dim2Mea_SurveyQuestionChoice_Convert_MaxValueStr_to_Number\"]},\"ED_CE_LoyaltyTierGroup_selected_TierGroup_Flag\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"SelectedTierGroup_Flag\",\"name\":\"SelectedTierGroup_Flag\",\"saqlExpression\":\"case when 'Id' == 'Selected_TierGroup_Id' then \\\"Yes\\\" else \\\"No\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"ED_CR_LoyaltyTierGroup_Primary_or_First_Group\"]},\"ED_CR_LoyaltyTierGroup_Primary_or_First_Group\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"Id\"},\"label\":\"Selected_TierGroup_Id\",\"name\":\"Selected_TierGroup_Id\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"isPrimary_Flag\"}],\"partitionBy\":[\"LoyaltyProgramId\"]},\"sources\":[\"ED_CE_LoyaltyTierGroup\"]},\"ED_Digest_LoyaltyProgram\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Status\"},{\"name\":\"Name\"},{\"name\":\"OwnerId\"},{\"name\":\"Id\"}],\"object\":\"LoyaltyProgram\"}},\"CX_Augment_Dummy_Self\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Question_Response_Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyResponse\",\"rightKey\":[\"Question_Response_Id\"],\"rightSelect\":[\"CompletionDateTime\"]},\"sources\":[\"CX_Filter_Dummy\",\"CX_Filter_Dummy\"]},\"CX_Augment_SurveyVersion_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveyVersionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyVersion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"VersionNumber\",\"SurveyId\"]},\"sources\":[\"CX_Augment_CSAT_SurveyQuestion_MaxValue_onto_SurveyQuestionresponse\",\"CX_Augment_Survey_onto_SurveyVersion\"]},\"CX_Augment_SurveyQuestion_onto_SurveyQuestionChoice\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"QuestionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyQuestion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"QuestionName\",\"QuestionType\"]},\"sources\":[\"CX_Digest_SurveyQuestionChoice\",\"CX_Digest_SurveyQuestion\"]},\"ED_Augment_JournalType_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"JournalTypeId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"JournalType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"ED_Digest_TransactionJournal\",\"ED_Digest_JournalType\"]},\"ED_Digest_LoyaltyMemberCurrency\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ExpirablePoints\"},{\"name\":\"Id\"},{\"name\":\"LoyaltyMemberId\"},{\"name\":\"LoyaltyProgramCurrencyId\"},{\"name\":\"Name\"},{\"name\":\"PointsBalance\"},{\"name\":\"TotalPointsAccrued\"},{\"name\":\"TotalPointsExpired\"},{\"name\":\"TotalPointsRedeemed\"}],\"object\":\"LoyaltyMemberCurrency\"}},\"CX_CR_Survey_Latest_CSAT_Response_Flag\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"NumberValue\",\"default\":\"-99\"},\"label\":\"Latest_CSAT_Response_Flag\",\"name\":\"Latest_CSAT_Response_Flag\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"SurveyResponse.CompletionDateTime\"}],\"partitionBy\":[\"Subject_Participant_Id\"]},\"sources\":[\"CX_Filter_Current_SurveyResponses_CSAT_Training\"]},\"ED_Filter_LoyaltyMemberCurrency\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'ProgramCurrency.Name' == \\\"Points\\\"\"},\"sources\":[\"ED_Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\"]},\"CX_CR_Survey_Latest_NPS_Response_Flag_Scoring\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"NumberValue\",\"default\":\"-99\"},\"label\":\"Latest_NPS_Response_Flag\",\"name\":\"Latest_NPS_Response_Flag\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"SurveyResponse.CompletionDateTime\"}],\"partitionBy\":[\"Subject_Participant_Id\"]},\"sources\":[\"CX_Filter_Current_SurveyResponses_Scoring\"]},\"CX_CR_Survey_Latest_NPS_Response_Flag\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"NumberValue\",\"default\":\"-99\"},\"label\":\"Latest_NPS_Response_Flag\",\"name\":\"Latest_NPS_Response_Flag\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"SurveyResponse.CompletionDateTime\"}],\"partitionBy\":[\"Subject_Participant_Id\"]},\"sources\":[\"CX_Filter_Current_SurveyResponses\"]},\"CX_CE_SurveyQuestionResponse\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"NPS_Response_Bucket\",\"name\":\"NPS_Response_Bucket\",\"saqlExpression\":\"case \\n    when 'NumberValue' >= 0 and 'NumberValue' <= 6 then \\\"Detractors\\\"\\nwhen 'NumberValue' >= 7  and 'NumberValue' <= 8 then \\\"Passives\\\" \\n    when 'NumberValue' >= 9  and 'NumberValue' <= 10 then \\\"Promoters\\\" \\n    end\",\"type\":\"Text\"},{\"defaultValue\":\"5\",\"label\":\"Scale\",\"name\":\"Scale\",\"precision\":2,\"saqlExpression\":\"5\",\"scale\":1,\"type\":\"Numeric\"},{\"label\":\"Subject_Participant_Id\",\"name\":\"Subject_Participant_Id\",\"saqlExpression\":\"'SurveySubject.SubjectId' + \\\" - \\\" + 'SurveySubject.SurveyInvitation.ParticipantId'\",\"type\":\"Text\"},{\"label\":\"CompletionDate_Flag\",\"name\":\"CompletionDate_Flag\",\"saqlExpression\":\"case \\nwhen date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) > 1 && date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) <= 7+18 then \\\"Current\\\" \\nwhen date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) > 7+18 && date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) <= 13+36 then \\\"Previous\\\" \\nelse \\\"Others\\\" end\",\"type\":\"Text\"},{\"label\":\"Subject_Participant_Survey_Version_Question_Id\",\"name\":\"Subject_Participant_Survey_Version_Question_Id\",\"saqlExpression\":\"'Subject_Participant_Id' + \\\" - \\\" + 'SurveySubject.SurveyId' + \\\" - \\\" + 'SurveyVersionId' + \\\" - \\\" + 'QuestionId'\",\"type\":\"Text\"},{\"defaultValue\":\"1\",\"label\":\"Count\",\"name\":\"Count\",\"precision\":10,\"saqlExpression\":\"1\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"NPS_Response_Number\",\"name\":\"NPS_Response_Number\",\"precision\":10,\"saqlExpression\":\"case \\nwhen 'NumberValue' >= 0 and 'NumberValue' <= 6 then -1\\nwhen 'NumberValue' >= 7  and 'NumberValue' <= 8 then 0 \\nwhen 'NumberValue' >= 9  and 'NumberValue' <= 10 then 1 \\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"CompletionDate_Flag_Scoring\",\"name\":\"CompletionDate_Flag_Scoring\",\"saqlExpression\":\"case \\nwhen date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) >= 1 && date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) < 7+18 then \\\"Current\\\" \\nwhen date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) >= 7+18 && date_diff(\\\"month\\\", toDate('SurveyResponse.CompletionDateTime_sec_epoch'), now()) < 13+36 then \\\"Previous\\\" \\nelse \\\"Others\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CX_Filter_SurveyQuestionResponse1\"]},\"CX_Augment_SurveyInvitation_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ParentId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyInvitation\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"InvitationLink\",\"InviteExpiryDateTime\",\"Name\",\"ParticipantId\",\"ResponseStatus\"]},\"sources\":[\"CX_Digest_SurveySubject\",\"CX_Filter_SurveyInvitation_with_Participants\"]},\"CX_CE_CSAT_For_Survey_Version_Question_Scoring\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"CSAT\",\"name\":\"CSAT\",\"precision\":10,\"saqlExpression\":\"('NumberValue' * 'Scale') / ('QuestionChoice.MaxValue')\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"CX_Filter_Current_SurveyResponses_CSAT_Scoring\"]},\"ED_CE_LoyaltyProgramMember\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Membership_Duration_days\",\"name\":\"Membership_Duration_days\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('EnrollmentDate_sec_epoch'), now())\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"InactivityFlag\",\"name\":\"InactivityFlag\",\"saqlExpression\":\"case when date_diff(\\\"month\\\", toDate('TransactionJournal.Last_Transaction_Activity_Date_sec_epoch'), now()) >= 1+11 then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"},{\"label\":\"InactivityFlag_Scoring\",\"name\":\"InactivityFlag_Scoring\",\"saqlExpression\":\"case when false then \\\"\\\" end\",\"type\":\"Text\"},{\"label\":\"Member_Count\",\"name\":\"Member_Count\",\"precision\":10,\"saqlExpression\":\"1\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"IsAReferral\",\"name\":\"IsAReferral\",\"saqlExpression\":\"case when ReferredById is not null then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Current_Transaction_Frequency\",\"name\":\"Current_Transaction_Frequency\",\"precision\":10,\"saqlExpression\":\"'Transactions.DaysBetweenCurrentTransactions'/('Transactions.Accrual_Transactions_Current_Period'+'Transactions.Redemption_Transactions_Current_Period')\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Previous_Transaction_Frequency\",\"name\":\"Previous_Transaction_Frequency\",\"precision\":10,\"saqlExpression\":\"'Transactions.DaysBetweenPreviousTransactions'/('Transactions.Accrual_Transactions_Previous_Period'+'Transactions.Redemption_Transactions_Previous_Period')\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Current_Transaction_Frequency_Scoring\",\"name\":\"Current_Transaction_Frequency_Scoring\",\"precision\":10,\"saqlExpression\":\"'Transactions.DaysBetweenCurrentTransactions_Scoring'/('Transactions.Accrual_Transactions_Current_Period_Scoring'+'Transactions.Redemption_Transactions_Current_Period_Scoring')\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Previous_Transaction_Frequency_Scoring\",\"name\":\"Previous_Transaction_Frequency_Scoring\",\"precision\":10,\"saqlExpression\":\"'Transactions.DaysBetweenPreviousTransactions_Scoring'/('Transactions.Accrual_Transactions_Previous_Period_Scoring'+'Transactions.Redemption_Transactions_Previous_Period_Scoring')\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Months_in_Tier\",\"name\":\"Months_in_Tier\",\"precision\":10,\"saqlExpression\":\"date_diff(\\\"month\\\", toDate('MemberTier.EffectiveDate_sec_epoch'), now()) \",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Contact_Age\",\"name\":\"Contact_Age\",\"precision\":10,\"saqlExpression\":\"date_diff(\\\"year\\\",toDate('Contact.Birthdate_sec_epoch'),now())\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Contact_MailingState\",\"name\":\"Contact_MailingState\",\"saqlExpression\":\"coalesce('Contact.MailingState', 'Account.BillingState')\",\"type\":\"Text\"},{\"label\":\"Contact_MailingCity\",\"name\":\"Contact_MailingCity\",\"saqlExpression\":\"coalesce('Contact.MailingCity','Account.BillingCity')\",\"type\":\"Text\"},{\"label\":\"DaysSinceLastActivity\",\"name\":\"DaysSinceLastActivity\",\"precision\":10,\"saqlExpression\":\"daysBetween(toDate('TransactionJournal.Last_Transaction_Activity_Date_sec_epoch'),now())\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"isTrainingData\",\"name\":\"isTrainingData\",\"saqlExpression\":\"\\\"true\\\"\",\"type\":\"Text\"},{\"label\":\"isTrainingData_Scoring\",\"name\":\"isTrainingData_Scoring\",\"saqlExpression\":\"\\\"false\\\"\",\"type\":\"Text\"},{\"label\":\"AccountContactId\",\"name\":\"AccountContactId\",\"saqlExpression\":\"coalesce('ContactId', 'AccountId')\",\"type\":\"Text\"},{\"label\":\"Contact_City_State\",\"name\":\"Contact_City_State\",\"saqlExpression\":\"Contact_MailingCity + \\\" - \\\" + Contact_MailingState\",\"type\":\"Text\"},{\"label\":\"MemberName\",\"name\":\"MemberName\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.Name' when 'MemberType' == \\\"Corporate\\\" then 'Account.Name' end\",\"type\":\"Text\"},{\"label\":\"MemberTenure\",\"name\":\"MemberTenure\",\"saqlExpression\":\"case  when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"30 days ago\\\"..\\\"current day\\\"] then \\\"1.< 1 month\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"90 days ago\\\"..\\\"31 days ago\\\"] then \\\"2.1-3 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"180 days ago\\\"..\\\"91 days ago\\\"] then \\\"3.3-6 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"270 days ago\\\"..\\\"181 days ago\\\"] then \\\"4.6-9 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"1 day ago - 1 year\\\"..\\\"271 days ago\\\"] then \\\"5.9-12 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"1 day ago - 2 years\\\"..\\\"current day - 1 year\\\"] then \\\"6.1-2 years\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"1 day ago - 5 years\\\"..\\\"current day - 2 years\\\"] then \\\"7.2-5 years\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [..\\\"current day - 5 years\\\"] then \\\"8.5+ years\\\" else \\\"9.NA\\\" end\",\"type\":\"Text\"},{\"label\":\"LeadOrContactId\",\"name\":\"LeadOrContactId\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'ContactId' when 'MemberType' == \\\"Corporate\\\" then 'Contact_Account.Id' end\",\"type\":\"Text\"},{\"label\":\"LeadOrContactName\",\"name\":\"LeadOrContactName\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.Name' when 'MemberType' == \\\"Corporate\\\" then 'Contact_Account.Name' end\",\"type\":\"Text\"},{\"label\":\"Scale\",\"name\":\"Scale\",\"precision\":10,\"saqlExpression\":\"5\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"CSAT\",\"name\":\"CSAT\",\"precision\":10,\"saqlExpression\":\"'Overall_CSAT.CSAT'/'Overall_CSAT.Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"NPS\",\"name\":\"NPS\",\"precision\":10,\"saqlExpression\":\"('Overall_NPS.NPS_Response_Number'/'Overall_NPS.Count')\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Latest_NPS\",\"name\":\"Latest_NPS\",\"precision\":10,\"saqlExpression\":\"'Latest_NPS.NumberValue'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Latest_CSAT\",\"name\":\"Latest_CSAT\",\"precision\":10,\"saqlExpression\":\"('Latest_CSAT.NumberValue'*Scale)/'Latest_CSAT.QuestionChoice.MaxValue'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"CSAT_Scoring\",\"name\":\"CSAT_Scoring\",\"precision\":10,\"saqlExpression\":\"'Overall_CSAT_Scoring.CSAT'/'Overall_CSAT_Scoring.Count'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"NPS_Scoring\",\"name\":\"NPS_Scoring\",\"precision\":10,\"saqlExpression\":\"('Overall_NPS_Scoring.NPS_Response_Number'/'Overall_NPS_Scoring.Count')\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Latest_NPS_Scoring\",\"name\":\"Latest_NPS_Scoring\",\"precision\":10,\"saqlExpression\":\"'Latest_NPS_Scoring.NumberValue'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Latest_CSAT_Scoring\",\"name\":\"Latest_CSAT_Scoring\",\"precision\":10,\"saqlExpression\":\"('Latest_CSAT_Scoring.NumberValue'*Scale)/'Latest_CSAT_Scoring.QuestionChoice.MaxValue'\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"CX_ED_Augment_latest_NPS_Survey_Scoring_onto_LoyaltyProgramMember\"]},\"CX_Filter_Current_SurveyResponses_CSAT_Training\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CompletionDate_Flag == \\\"Current\\\"\"},\"sources\":[\"CX_Augment_SurveyVersion_onto_SurveyQuestionResponse\"]},\"ED_Augment_Contact_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ContactId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Contact\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Birthdate\",\"MailingState\",\"MailingCity\",\"Name\"]},\"sources\":[\"ED_Augment_Contact_via_Account_onto_LoyaltyProgramMember\",\"ED_Digest_Contact\"]},\"ED_Slice_Scoring_Columns\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"isTrainingData_Scoring\"},{\"name\":\"MemberCurrency.Ledger.Current_Accrued_Points_Scoring\"},{\"name\":\"MemberCurrency.Ledger.Current_Expired_Points_Scoring\"},{\"name\":\"MemberCurrency.Ledger.Current_Redeemed_Points_Scoring\"},{\"name\":\"MemberCurrency.Ledger.Previous_Accrued_Points_Scoring\"},{\"name\":\"MemberCurrency.Ledger.Previous_Expired_Points_Scoring\"},{\"name\":\"MemberCurrency.Ledger.Previous_Redeemed_Points_Scoring\"},{\"name\":\"Previous_Transaction_Frequency_Scoring\"},{\"name\":\"Transactions.Accrual_Transactions_Current_Period_Scoring\"},{\"name\":\"Transactions.Accrual_Transactions_Previous_Period_Scoring\"},{\"name\":\"Transactions.DaysBetweenCurrentTransactions_Scoring\"},{\"name\":\"Transactions.DaysBetweenPreviousTransactions_Scoring\"},{\"name\":\"Transactions.Redemption_Transactions_Current_Period_Scoring\"},{\"name\":\"Transactions.Redemption_Transactions_Previous_Period_Scoring\"},{\"name\":\"Transactions.Transaction_Amount_Previous_Period_Scoring\"},{\"name\":\"Transactions.Transaction_Amount_Current_Period_Scoring\"},{\"name\":\"Current_Transaction_Frequency_Scoring\"},{\"name\":\"InactivityFlag_Scoring\"},{\"name\":\"CSAT_Scoring\"},{\"name\":\"NPS_Scoring\"},{\"name\":\"Latest_NPS_Scoring\"},{\"name\":\"Latest_CSAT_Scoring\"}],\"mode\":\"drop\"},\"sources\":[\"ED_MultiValue_Augment_LoyaltyProgramMember_onto_self_for_Referrals\"]},\"ED_Update_Columns_for_Scoring\":{\"action\":\"update\",\"parameters\":{\"leftKey\":[\"Id\"],\"rightKey\":[\"Id\"],\"updateColumns\":{\"MemberCurrency.Ledger.Current_Expired_Points\":\"MemberCurrency.Ledger.Current_Expired_Points_Scoring\",\"isTrainingData\":\"isTrainingData_Scoring\",\"MemberCurrency.Ledger.Current_Accrued_Points\":\"MemberCurrency.Ledger.Current_Accrued_Points_Scoring\",\"Transactions.Transaction_Amount_Previous_Period\":\"Transactions.Transaction_Amount_Previous_Period_Scoring\",\"MemberCurrency.Ledger.Previous_Expired_Points\":\"MemberCurrency.Ledger.Previous_Expired_Points_Scoring\",\"Transactions.DaysBetweenCurrentTransactions\":\"Transactions.DaysBetweenCurrentTransactions_Scoring\",\"NPS\":\"NPS_Scoring\",\"Latest_CSAT\":\"Latest_CSAT_Scoring\",\"Transactions.Transaction_Amount_Current_Period\":\"Transactions.Transaction_Amount_Current_Period_Scoring\",\"Transactions.Accrual_Transactions_Current_Period\":\"Transactions.Accrual_Transactions_Current_Period_Scoring\",\"Transactions.DaysBetweenPreviousTransactions\":\"Transactions.DaysBetweenPreviousTransactions_Scoring\",\"Current_Transaction_Frequency\":\"Current_Transaction_Frequency_Scoring\",\"MemberCurrency.Ledger.Previous_Redeemed_Points\":\"MemberCurrency.Ledger.Previous_Redeemed_Points_Scoring\",\"Transactions.Redemption_Transactions_Previous_Period\":\"Transactions.Redemption_Transactions_Previous_Period_Scoring\",\"InactivityFlag\":\"InactivityFlag_Scoring\",\"Transactions.Redemption_Transactions_Current_Period\":\"Transactions.Redemption_Transactions_Current_Period_Scoring\",\"MemberCurrency.Ledger.Previous_Accrued_Points\":\"MemberCurrency.Ledger.Previous_Accrued_Points_Scoring\",\"Previous_Transaction_Frequency\":\"Previous_Transaction_Frequency_Scoring\",\"CSAT\":\"CSAT_Scoring\",\"Latest_NPS\":\"Latest_NPS_Scoring\",\"MemberCurrency.Ledger.Current_Redeemed_Points\":\"MemberCurrency.Ledger.Current_Redeemed_Points_Scoring\",\"Transactions.Accrual_Transactions_Previous_Period\":\"Transactions.Accrual_Transactions_Previous_Period_Scoring\"}},\"sources\":[\"ED_Slice_Scoring_Columns\",\"ED_MultiValue_Augment_LoyaltyProgramMember_onto_self_for_Referrals\"]},\"ED_Filter_LoyaltyLedger_get_NonGroupMember_AccrualReversals\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TransactionJournal.JournalType.Name' == \\\"Accrual Reversal\\\" and 'TransactionJournal.JournalType.Name' != \\\"Group\\\"\"},\"sources\":[\"ED_Augment_TransactionJournal_onto_LoyaltyLedger\"]},\"ED_CR_TransactionJournal_Last_Activity\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActivityDate\"},\"label\":\"Last_Transaction_Activity_Date\",\"name\":\"Last_Transaction_Activity_Date\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"ActivityDate\"}],\"partitionBy\":[\"MemberId\"]},\"sources\":[\"ED_CR_TransactionJournal_DaysBetweenPreviousTransactions_Scoring\"]},\"CX_Filter_SurveySubject_with_Participants\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyInvitation.ParticipantId' is not null\"},\"sources\":[\"CX_Augment_Survey_onto_SurveySubject\"]},\"ED_Augment_LoyaltyLedger_onto_LoyaltyMemberCurrency\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramCurrencyId\",\"LoyaltyMemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Ledger\",\"rightKey\":[\"LoyaltyProgramCurrencyId\",\"LoyaltyProgramMemberId\"],\"rightSelect\":[\"Current_Accrued_Points\",\"Current_Expired_Points\",\"Current_Redeemed_Points\",\"Previous_Accrued_Points\",\"Previous_Expired_Points\",\"Previous_Redeemed_Points\",\"Current_Accrued_Points_Scoring\",\"Current_Expired_Points_Scoring\",\"Current_Redeemed_Points_Scoring\",\"Previous_Accrued_Points_Scoring\",\"Previous_Expired_Points_Scoring\",\"Previous_Redeemed_Points_Scoring\"]},\"sources\":[\"ED_Filter_LoyaltyMemberCurrency\",\"ED_CE_LoyaltyLedger\"]},\"CX_Digest_LoyaltyProgram\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Description\"},{\"name\":\"Name\"},{\"name\":\"Status\"}],\"object\":\"LoyaltyProgram\"}},\"ED_CR_TransactionJournal_DaysBetweenCurrentTransactions_Scoring\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"daysBetween(toDate(current('Current_ActivityDate_Scoring_sec_epoch')),toDate(previous('Current_ActivityDate_Scoring_sec_epoch')))\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"DaysBetweenCurrentTransactions_Scoring\",\"name\":\"DaysBetweenCurrentTransactions_Scoring\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Current_ActivityDate_Scoring\"}],\"partitionBy\":[\"MemberId\"]},\"sources\":[\"ED_CR_TransactionJournal_DaysBetweenPreviousTransactions\"]},\"CX_ED_Augment_latest_CSAT_Survey_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Latest_CSAT\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"NumberValue\",\"QuestionChoice.MaxValue\"]},\"sources\":[\"CX_ED_Augment_overall_CSAT_Survey_onto_LoyaltyProgramMember\",\"CX_Filter_Survey_Latest_CSAT_Response\"]},\"ED_Filter_Accrual_Redemption_Transactions\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'JournalType.Name' in [\\\"Accrual\\\", \\\"Redemption\\\"] && 'Status' == \\\"Processed\\\"\"},\"sources\":[\"ED_CE_TransactionJournal\"]},\"CX_ED_Augment_overall_NPS_Survey_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Overall_NPS\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"NPS_Response_Number\",\"Count\"]},\"sources\":[\"CX_ED_Augment_latest_CSAT_Survey_Scoring_onto_LoyaltyProgramMember\",\"CX_Filter_Current_SurveyResponses\"]},\"CX_Augment_SurveyQuestion_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"QuestionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyQuestion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"QuestionType\",\"QuestionName\",\"Name\"]},\"sources\":[\"CX_Digest_SurveyQuestionResponse\",\"CX_Digest_SurveyQuestion\"]},\"CX_Digest_SurveyResponse\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CompletionDateTime\"},{\"name\":\"CreatedDate\"},{\"name\":\"Id\"},{\"name\":\"InterviewGuid\"},{\"name\":\"InterviewId\"},{\"name\":\"InvitationId\"},{\"name\":\"IpAddress\"},{\"name\":\"IsDeleted\"},{\"name\":\"Language\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"Status\"},{\"name\":\"SubmitterId\"},{\"name\":\"SurveyId\"},{\"name\":\"SurveyVersionId\"}],\"object\":\"SurveyResponse\"}},\"CX_CE_Dummy\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"QuestionId\",\"name\":\"QuestionId\",\"saqlExpression\":\"\\\"All\\\"\",\"type\":\"Text\"},{\"label\":\"Question_Response_Id\",\"name\":\"Question_Response_Id\",\"saqlExpression\":\"\\\"All\\\"\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"CompletionDateTime\",\"name\":\"CompletionDateTime\",\"saqlExpression\":\"toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"CX_Digest_LoyaltyProgram\"]},\"CX_Augment_SurveySubject_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"InvitationId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveySubject\",\"rightKey\":[\"SurveyInvitationId\"],\"rightSelect\":[\"Id\",\"IsDeleted\",\"Name\",\"ParentId\",\"SubjectEntityType\",\"SubjectId\",\"SurveyId\",\"SurveyInvitationId\",\"SurveyResponseId\",\"SurveyInvitation.Id\",\"SurveyInvitation.Name\",\"SurveyInvitation.ParticipantId\",\"SurveyInvitation.ResponseStatus\",\"Survey.Description\",\"Survey.Name\",\"Survey.SurveyType\"]},\"sources\":[\"CX_CR_SurveyQuestionResponse\",\"CX_Filter_SurveySubject_with_Participants\"]},\"CX_Filter_Survey_Latest_NPS_Response\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Latest_NPS_Response_Flag == -99\"},\"sources\":[\"CX_CR_Survey_Latest_NPS_Response_Flag\"]},\"ED_Augment_Account_onto_Contact\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Account\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Id\"]},\"sources\":[\"ED_Digest_Contact\",\"ED_Digest_Account\"]},\"CX_CR_Dummy\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"next()\",\"sourceField\":\"QuestionId\",\"default\":\"Dummy\"},\"label\":\"CR_Computed_Dummy\",\"name\":\"CR_Computed_Dummy\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"QuestionId\"}],\"partitionBy\":[\"QuestionId\"]},\"sources\":[\"CX_CE_Dummy\"]},\"CX_Filter_SurveyInvitation_with_Participants\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'ParticipantId' is not null\"},\"sources\":[\"CX_Digest_SurveyInvitation\"]},\"ED_Augment_Contact_via_Account_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Contact_Account\",\"rightKey\":[\"Account.Id\"],\"rightSelect\":[\"Id\",\"Name\"]},\"sources\":[\"ED_Augment_Account_onto_LoyaltyProgramMember\",\"ED_Augment_Account_onto_Contact\"]},\"ED_Augment_LoyaltyProgram_onto_LoyaltyTierGroup\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Program\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"Name\",\"OwnerId\",\"Status\"]},\"sources\":[\"ED_Digest_LoyaltyTierGroup\",\"ED_Digest_LoyaltyProgram\"]},\"CX_ED_Augment_overall_CSAT_Survey_Scoring_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Overall_CSAT_Scoring\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"CSAT\",\"Count\"]},\"sources\":[\"CX_ED_Augment_latest_CSAT_Survey_onto_LoyaltyProgramMember\",\"CX_CE_CSAT_For_Survey_Version_Question_Scoring\"]},\"ED_Digest_Contact\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Birthdate\"},{\"name\":\"Id\"},{\"name\":\"MailingState\"},{\"name\":\"MailingCity\"},{\"name\":\"Name\"},{\"name\":\"AccountId\"}],\"object\":\"Contact\"}},\"CX_Augment_CSAT_SurveyQuestion_MaxValue_onto_SurveyQuestionresponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"QuestionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"QuestionChoice\",\"rightKey\":[\"QuestionId\"],\"rightSelect\":[\"MaxValue\",\"MaxValueString\"]},\"sources\":[\"CX_Filter_SurveyQuestionResponse_CSAT_Responses\",\"CX_CR_SurveyQuestionChoice1\"]},\"CX_Augment_Survey_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Survey\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Description\",\"Name\",\"SurveyType\"]},\"sources\":[\"CX_Augment_SurveyInvitation_onto_SurveySubject\",\"CX_Digest_Survey\"]},\"ED_Augment_Ledger_GroupMember_RelatedJournal_onto_MemberJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"TransactionJournal.RelatedJournalId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RelatedTransactionJournal1\",\"rightKey\":[\"TransactionJournalId\"],\"rightSelect\":[\"TransactionJournal.RelatedJournalId\"]},\"sources\":[\"ED_Filter_GroupMembers_From_LoyaltyLedger\",\"ED_Augment_TransactionJournal_onto_LoyaltyLedger\"]},\"CX_Digest_SurveyQuestionChoice\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"QuestionId\"}],\"object\":\"SurveyQuestionChoice\"}},\"ED_CR_TransactionJournal_DaysBetweenPreviousTransactions_Scoring\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"daysBetween(toDate(current('Previous_ActivityDate_Scoring_sec_epoch')),toDate(previous('Previous_ActivityDate_Scoring_sec_epoch')))\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"DaysBetweenPreviousTransactions_Scoring\",\"name\":\"DaysBetweenPreviousTransactions_Scoring\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Previous_ActivityDate_Scoring\"}],\"partitionBy\":[\"MemberId\"]},\"sources\":[\"ED_CR_TransactionJournal_DaysBetweenCurrentTransactions_Scoring\"]},\"CX_Filter_Current_SurveyResponses_Scoring\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CompletionDate_Flag_Scoring == \\\"Current\\\"\"},\"sources\":[\"CX_Filter_SurveyQuestionResponse_NPS_Responses\"]},\"CX_CE_SurveyQuestionResponse_QuesTypeResponseId\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"QuesTypeResponseID\",\"name\":\"QuesTypeResponseID\",\"saqlExpression\":\"'SurveyQuestion.QuestionType'+ \\\" - \\\" + 'QuestionId' + \\\" - \\\" + 'ResponseId'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CX_Append_SurveyQuestionResponse_with_Dummy\"]},\"CX_ED_Augment_latest_CSAT_Survey_Scoring_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Latest_CSAT_Scoring\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"NumberValue\",\"QuestionChoice.MaxValue\"]},\"sources\":[\"CX_ED_Augment_overall_CSAT_Survey_Scoring_onto_LoyaltyProgramMember\",\"CX_Filter_Survey_Latest_CSAT_Response_Scoring\"]},\"ED_MultiValue_Augment_Transactions_onto_Members\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\",\"ProgramId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Transactions\",\"rightKey\":[\"MemberId\",\"LoyaltyProgramId\"],\"rightSelect\":[\"LoyaltyProgramMember.MemberType\",\"Accrual_Transactions_Current_Period\",\"Redemption_Transactions_Current_Period\",\"Transaction_Amount_Current_Period\",\"Accrual_Transactions_Previous_Period\",\"Redemption_Transactions_Previous_Period\",\"Transaction_Amount_Previous_Period\",\"Transactions_all\",\"Transaction_Amount_all\",\"Accrual_Transactions_Current_Period_Scoring\",\"Redemption_Transactions_Current_Period_Scoring\",\"Transaction_Amount_Current_Period_Scoring\",\"Accrual_Transactions_Previous_Period_Scoring\",\"Redemption_Transactions_Previous_Period_Scoring\",\"Transaction_Amount_Previous_Period_Scoring\",\"DaysBetweenCurrentTransactions\",\"DaysBetweenPreviousTransactions\",\"DaysBetweenCurrentTransactions_Scoring\",\"DaysBetweenPreviousTransactions_Scoring\"]},\"sources\":[\"ED_Augment_LoyaltyMemberTier_onto_LoyaltyProgramMember\",\"ED_CR_TransactionJournal_Last_Activity\"]},\"ED_Augment_Ledger_with_GroupMemberFinalRelatedJournal_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"TransactionJournalId\",\"LoyaltyProgramCurrencyId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"GroupPoints\",\"rightKey\":[\"RelatedTransactionJournal\",\"LoyaltyProgramCurrencyId\"],\"rightSelect\":[\"Points\"]},\"sources\":[\"ED_Augment_TransactionJournal_onto_LoyaltyLedger\",\"ED_CE_LoyaltyLedger_DeriveFinalRelatedJournal\"]},\"CX_Filter_SurveyQuestionChoice_with_RatingQuestion\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyQuestion.QuestionType' == \\\"Rating\\\"\"},\"sources\":[\"CX_Augment_SurveyQuestion_onto_SurveyQuestionChoice\"]},\"CX_Append_SurveyQuestionResponse_with_Dummy\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"CX_Augment_Dummy_Self\",\"CX_Augment_SurveyResponse_onto_SurveyQuestionResponse\"]},\"ED_Filter_LoyaltyTierGroup\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SelectedTierGroup_Flag' == \\\"Yes\\\"\"},\"sources\":[\"ED_CE_LoyaltyTierGroup_selected_TierGroup_Flag\"]},\"ED_Slice_LoyaltyLedger_DropExistingPointsField\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"Points\"},{\"name\":\"GroupPoints.Points\"}],\"mode\":\"drop\"},\"sources\":[\"ED_CE_LoyaltyLedger_DeriveUpdatedPoints\"]},\"ED_Filter_Training_Data\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'isTrainingData' == \\\"true\\\"\"},\"sources\":[\"ED_Append_Training_and_Scoring_data\"]},\"ED_Digest_JournalType\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"JournalType\"}},\"CX_Filter_SurveyQuestionResponse_NPS_Responses\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyQuestion.QuestionType' in [\\\"NPS\\\"]\"},\"sources\":[\"CX_CE_SurveyQuestionResponse\"]},\"CX_ED_Augment_latest_NPS_Survey_Scoring_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Latest_NPS_Scoring\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"NPS_Response_Bucket\",\"NumberValue\"]},\"sources\":[\"CX_ED_Augment_overall_NPS_Survey_Scoring_onto_LoyaltyProgramMember\",\"CX_Filter_Survey_Latest_NPS_Response_Scoring\"]},\"CX_Filter_Current_SurveyResponses_CSAT_Scoring\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CompletionDate_Flag_Scoring == \\\"Current\\\"\"},\"sources\":[\"CX_Augment_SurveyVersion_onto_SurveyQuestionResponse\"]},\"ED_Digest_Account\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"},{\"name\":\"BillingCity\"},{\"name\":\"BillingState\"}],\"object\":\"Account\"}},\"CX_Filter_Survey_Latest_NPS_Response_Scoring\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Latest_NPS_Response_Flag == -99\"},\"sources\":[\"CX_CR_Survey_Latest_NPS_Response_Flag_Scoring\"]},\"CX_Filter_Dummy\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CR_Computed_Dummy == \\\"Dummy\\\"\"},\"sources\":[\"CX_CR_Dummy\"]},\"ED_Augment_LoyaltyProgram_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Program\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"ED_Augment_Contact_onto_LoyaltyProgramMember\",\"ED_Digest_LoyaltyProgram\"]},\"CX_Filter_SurveyQuestionResponse1\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"FirstResponseValue is null && 'CR_Computed_Dummy' != \\\"Dummy\\\" && 'SurveySubject.SubjectEntityType' in [\\\"LoyaltyProgram\\\"]\"},\"sources\":[\"CX_Augment_SurveySubject_onto_SurveyQuestionResponse\"]},\"ED_Augment_LoyaltyTierGroup_onto_LoyaltyMemberTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyTierGroupId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"TierGroup\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"LoyaltyProgramId\",\"Name\",\"Program.Id\",\"Program.Name\",\"Program.OwnerId\",\"Program.Status\",\"SelectedTierGroup_Flag\"]},\"sources\":[\"ED_Digest_LoyaltyMemberTier\",\"ED_Filter_LoyaltyTierGroup\"]},\"CX_Digest_SurveyInvitation\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"InvitationLink\"},{\"name\":\"InviteExpiryDateTime\"},{\"name\":\"IsDefault\"},{\"name\":\"Name\"},{\"name\":\"ParticipantId\"},{\"name\":\"ResponseStatus\"},{\"name\":\"SurveyId\"},{\"name\":\"IsDeleted\"}],\"object\":\"SurveyInvitation\"}},\"ED_CE_TransactionTypes\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"ActivityDate_Flag\",\"name\":\"ActivityDate_Flag\",\"saqlExpression\":\"case \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) > 1 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) <= 7+18 then \\\"Current\\\" \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) > 7+18 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) <= 13+36 then \\\"Previous\\\" \\nelse \\\"Others\\\" end\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Accrual_Transactions_Current_Period\",\"name\":\"Accrual_Transactions_Current_Period\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Accrual\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag' == \\\"Current\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Redemption_Transactions_Current_Period\",\"name\":\"Redemption_Transactions_Current_Period\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Redemption\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag' == \\\"Current\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Transaction_Amount_Current_Period\",\"name\":\"Transaction_Amount_Current_Period\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' in [\\\"Accrual\\\", \\\"Redemption\\\"] && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag' == \\\"Current\\\" then 'TransactionAmount' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Accrual_Transactions_Previous_Period\",\"name\":\"Accrual_Transactions_Previous_Period\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Accrual\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag' == \\\"Previous\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Redemption_Transactions_Previous_Period\",\"name\":\"Redemption_Transactions_Previous_Period\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Redemption\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag' == \\\"Previous\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Transaction_Amount_Previous_Period\",\"name\":\"Transaction_Amount_Previous_Period\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' in [\\\"Accrual\\\", \\\"Redemption\\\"] && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag' == \\\"Previous\\\" then 'TransactionAmount' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Transactions_all\",\"name\":\"Transactions_all\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Accrual\\\" && 'Status' == \\\"Processed\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Transaction_Amount_all\",\"name\":\"Transaction_Amount_all\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' in [\\\"Accrual\\\", \\\"Redemption\\\"] && 'Status' == \\\"Processed\\\" then 'TransactionAmount' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"ActivityDate_Flag_Scoring\",\"name\":\"ActivityDate_Flag_Scoring\",\"saqlExpression\":\"case \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) >= 1 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) < 7+18 then \\\"Current\\\" \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) >= 7+18 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) < 13+36 then \\\"Previous\\\" \\nelse \\\"Others\\\" end\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Accrual_Transactions_Current_Period_Scoring\",\"name\":\"Accrual_Transactions_Current_Period_Scoring\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Accrual\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Redemption_Transactions_Current_Period_Scoring\",\"name\":\"Redemption_Transactions_Current_Period_Scoring\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Redemption\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Transaction_Amount_Current_Period_Scoring\",\"name\":\"Transaction_Amount_Current_Period_Scoring\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' in [\\\"Accrual\\\", \\\"Redemption\\\"] && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then 'TransactionAmount' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Accrual_Transactions_Previous_Period_Scoring\",\"name\":\"Accrual_Transactions_Previous_Period_Scoring\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Accrual\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Redemption_Transactions_Previous_Period_Scoring\",\"name\":\"Redemption_Transactions_Previous_Period_Scoring\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' == \\\"Redemption\\\" && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then 1 else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Transaction_Amount_Previous_Period_Scoring\",\"name\":\"Transaction_Amount_Previous_Period_Scoring\",\"precision\":10,\"saqlExpression\":\"case when 'JournalType.Name' in [\\\"Accrual\\\", \\\"Redemption\\\"] && 'Status' == \\\"Processed\\\" && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then 'TransactionAmount' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Product_or_ProductCategory_ID\",\"name\":\"Product_or_ProductCategory_ID\",\"saqlExpression\":\"coalesce('ProductId', 'ProductCategoryId')\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"Current_ActivityDate_Scoring\",\"name\":\"Current_ActivityDate_Scoring\",\"saqlExpression\":\"case when 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then toDate('ActivityDate_sec_epoch') end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"Previous_ActivityDate_Scoring\",\"name\":\"Previous_ActivityDate_Scoring\",\"saqlExpression\":\"case when 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then toDate('ActivityDate_sec_epoch') end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"Current_ActivityDate\",\"name\":\"Current_ActivityDate\",\"saqlExpression\":\"case when 'ActivityDate_Flag' == \\\"Current\\\" then toDate('ActivityDate_sec_epoch') end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"Previous_ActivityDate\",\"name\":\"Previous_ActivityDate\",\"saqlExpression\":\"case when 'ActivityDate_Flag' == \\\"Previous\\\" then toDate('ActivityDate_sec_epoch') end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"ED_Filter_Accrual_Redemption_Transactions\"]},\"CX_Filter_Current_SurveyResponses\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CompletionDate_Flag == \\\"Current\\\"\"},\"sources\":[\"CX_Filter_SurveyQuestionResponse_NPS_Responses\"]},\"ED_Digest_LoyaltyLedger\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActivityDate\"},{\"name\":\"CreatedDate\"},{\"name\":\"EventType\"},{\"name\":\"ExpiryDate\"},{\"name\":\"Id\"},{\"name\":\"LoyaltyProgramCurrencyId\"},{\"name\":\"LoyaltyProgramMemberId\"},{\"name\":\"Points\"},{\"name\":\"TransactionJournalId\"}],\"object\":\"LoyaltyLedger\"}},\"CX_Filter_Survey_Latest_CSAT_Response\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Latest_CSAT_Response_Flag == -99\"},\"sources\":[\"CX_CR_Survey_Latest_CSAT_Response_Flag\"]},\"ED_CR_TransactionJournal_DaysBetweenCurrentTransactions\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"daysBetween(toDate(current('Current_ActivityDate_sec_epoch')),toDate(previous('Current_ActivityDate_sec_epoch')))\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"DaysBetweenCurrentTransactions\",\"name\":\"DaysBetweenCurrentTransactions\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Current_ActivityDate\"}],\"partitionBy\":[\"MemberId\"]},\"sources\":[\"ED_CE_TransactionTypes\"]},\"CX_CR_Survey_Latest_CSAT_Response_Flag_Scoring\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"NumberValue\",\"default\":\"-99\"},\"label\":\"Latest_CSAT_Response_Flag\",\"name\":\"Latest_CSAT_Response_Flag\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"SurveyResponse.CompletionDateTime\"}],\"partitionBy\":[\"Subject_Participant_Id\"]},\"sources\":[\"CX_Filter_Current_SurveyResponses_CSAT_Scoring\"]},\"ED_Augment_LoyaltyProgramMember_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"MemberId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramMember\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"MemberType\"]},\"sources\":[\"ED_Augment_JournalType_onto_TransactionJournal\",\"ED_Digest_LoyaltyProgramMember\"]},\"ED_Filter_GroupMembers_From_LoyaltyLedger\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\"\"},\"sources\":[\"ED_Augment_TransactionJournal_onto_LoyaltyLedger\"]},\"CX_Filter_SurveyQuestionResponse\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyQuestion.QuestionType' in [\\\"NPS\\\", \\\"Rating\\\"]\"},\"sources\":[\"CX_Augment_SurveyQuestion_onto_SurveyQuestionResponse\"]},\"CX_ED_Augment_latest_NPS_Survey_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Latest_NPS\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"NPS_Response_Bucket\",\"NumberValue\"]},\"sources\":[\"CX_ED_Augment_overall_NPS_Survey_onto_LoyaltyProgramMember\",\"CX_Filter_Survey_Latest_NPS_Response\"]},\"CX_Digest_Survey\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActiveVersionId\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"Description\"},{\"name\":\"DeveloperName\"},{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"SurveyType\"},{\"name\":\"TotalVersionsCount\"},{\"name\":\"LatestVersionId\"}],\"object\":\"Survey\"}},\"CX_Append_SurveyQuestionChoice_w_RatingQuestion_with_Dummy\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"CX_Filter_Dummy\",\"CX_Filter_SurveyQuestionChoice_with_RatingQuestion\"]},\"ED_Digest_LoyaltyProgramMember\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"ContactId\"},{\"name\":\"EnrollmentChannel\"},{\"name\":\"EnrollmentDate\"},{\"name\":\"Id\"},{\"name\":\"LastActivityDate\"},{\"name\":\"MembershipEndDate\"},{\"name\":\"MemberStatus\"},{\"name\":\"MemberType\"},{\"name\":\"ProgramId\"},{\"name\":\"ReferredById\"}],\"object\":\"LoyaltyProgramMember\"}},\"ED_CE_LoyaltyLedger\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"Others\",\"label\":\"ActivityDate_Flag\",\"name\":\"ActivityDate_Flag\",\"precision\":15,\"saqlExpression\":\"case \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) > 1 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) <= 7+18 then \\\"Current\\\" \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) > 7+18 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) <= 13+36 then \\\"Previous\\\" \\nelse \\\"Others\\\" end\",\"type\":\"Text\"},{\"label\":\"Points\",\"name\":\"Points\",\"precision\":10,\"saqlExpression\":\"'PointsTemp'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"TransactionType_w_GroupMember\",\"name\":\"TransactionType_w_GroupMember\",\"saqlExpression\":\"case \\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Credit\\\" then \\n    case \\n        when 'TransactionJournal.JournalType.Name' == \\\"Accrual\\\" then \\\"Accrual\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Manual Points Adjustment\\\" then \\\"AdjustedPoints_Positive\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Redemption Reversal\\\" then \\\"RedemptionReversal\\\" \\n    end \\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Debit\\\" then \\n    case \\n        when 'TransactionJournal.JournalType.Name' == \\\"Redemption\\\" then \\\"Redemption\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Manual Points Adjustment\\\" then \\\"AdjustedPoints_Negative\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Accrual Reversal\\\" then \\\"AccrualReversal\\\"\\n    end\\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Transfer\\\" && 'TransactionJournal.JournalType.Name' == \\\"Accrual\\\" then \\n    \\\"Accrual_Transfer\\\"\\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Expiry\\\" then \\n    \\\"Expired\\\"\\nend\",\"type\":\"Text\"},{\"label\":\"TransactionType\",\"name\":\"TransactionType\",\"saqlExpression\":\"case when 'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'TransactionType_w_GroupMember' == \\\"Accrual\\\" then \\\"Accrual\\\"+\\\"_Group\\\" else 'TransactionType_w_GroupMember' end\",\"type\":\"Text\"},{\"label\":\"Current_Accrued_Points\",\"name\":\"Current_Accrued_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Accrual\\\", \\\"AdjustedPoints_Positive\\\"] && 'ActivityDate_Flag' == \\\"Current\\\" then 'Points'\\n    when 'TransactionType' == \\\"AdjustedPoints_Negative\\\" then -'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Previous_Accrued_Points\",\"name\":\"Previous_Accrued_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Accrual\\\", \\\"AdjustedPoints_Positive\\\"] && 'ActivityDate_Flag' == \\\"Previous\\\" then 'Points'\\n    when 'TransactionType' == \\\"AdjustedPoints_Negative\\\" && 'ActivityDate_Flag' == \\\"Previous\\\" then -'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Current_Redeemed_Points\",\"name\":\"Current_Redeemed_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Redemption\\\"] && 'ActivityDate_Flag' == \\\"Current\\\" then 'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Previous_Redeemed_Points\",\"name\":\"Previous_Redeemed_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Redemption\\\"] && 'ActivityDate_Flag' == \\\"Previous\\\" then 'Points'\\n else 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Current_Expired_Points\",\"name\":\"Current_Expired_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Expired\\\"] && 'ActivityDate_Flag' == \\\"Current\\\" then 'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Previous_Expired_Points\",\"name\":\"Previous_Expired_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Expired\\\"] && 'ActivityDate_Flag' == \\\"Previous\\\" then 'Points'\\n else 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"Others\",\"label\":\"ActivityDate_Flag_Scoring\",\"name\":\"ActivityDate_Flag_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) >= 1 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) < 7+18 then \\\"Current\\\" \\nwhen date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) >= 7+18 && date_diff(\\\"month\\\", toDate('ActivityDate_sec_epoch'), now()) < 13+36 then \\\"Previous\\\" \\nelse \\\"Others\\\" end\",\"type\":\"Text\"},{\"label\":\"Current_Accrued_Points_Scoring\",\"name\":\"Current_Accrued_Points_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Accrual\\\", \\\"AdjustedPoints_Positive\\\"] && 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then 'Points'\\n    when 'TransactionType' == \\\"AdjustedPoints_Negative\\\" then -'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Previous_Accrued_Points_Scoring\",\"name\":\"Previous_Accrued_Points_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Accrual\\\", \\\"AdjustedPoints_Positive\\\"] && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then 'Points'\\n    when 'TransactionType' == \\\"AdjustedPoints_Negative\\\" && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then -'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Current_Redeemed_Points_Scoring\",\"name\":\"Current_Redeemed_Points_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Redemption\\\"] && 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then 'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Previous_Redeemed_Points_Scoring\",\"name\":\"Previous_Redeemed_Points_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Redemption\\\"] && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then 'Points'\\n else 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Current_Expired_Points_Scoring\",\"name\":\"Current_Expired_Points_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Expired\\\"] && 'ActivityDate_Flag_Scoring' == \\\"Current\\\" then 'Points'\\nelse 0\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Previous_Expired_Points_Scoring\",\"name\":\"Previous_Expired_Points_Scoring\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Expired\\\"] && 'ActivityDate_Flag_Scoring' == \\\"Previous\\\" then 'Points'\\n else 0\\nend\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"ED_Slice_LoyaltyLedger_DropExistingPointsField\"]},\"CX_ED_Augment_overall_CSAT_Survey_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\",\"ContactId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Overall_CSAT\",\"rightKey\":[\"SurveySubject.SubjectId\",\"SurveySubject.SurveyInvitation.ParticipantId\"],\"rightSelect\":[\"CSAT\",\"Count\"]},\"sources\":[\"ED_Augment_LoyaltyMemberCurrency_onto_LoyaltyProgramMember\",\"CX_CE_CSAT_For_Survey_Version_Question\"]},\"CX_Digest_SurveyVersion\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"SurveyId\"},{\"name\":\"VersionNumber\"}],\"object\":\"SurveyVersion\"}},\"CX_CE_CSAT_For_Survey_Version_Question\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"CSAT\",\"name\":\"CSAT\",\"precision\":10,\"saqlExpression\":\"('NumberValue' * 'Scale') / ('QuestionChoice.MaxValue')\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"CX_Filter_Current_SurveyResponses_CSAT_Training\"]},\"ED_SingleValue_Augment_Transactions_onto_Members\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\",\"ProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"TransactionJournal\",\"rightKey\":[\"MemberId\",\"LoyaltyProgramId\"],\"rightSelect\":[\"Last_Transaction_Activity_Date\"]},\"sources\":[\"ED_MultiValue_Augment_Transactions_onto_Members\",\"ED_CR_TransactionJournal_Last_Activity\"]},\"ED_Digest_LoyaltyProgramCurrency\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"}],\"object\":\"LoyaltyProgramCurrency\"}},\"CX_Digest_SurveyQuestion\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"DeveloperName\"},{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"IsDeprecated\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"QuestionName\"},{\"name\":\"QuestionType\"},{\"name\":\"SurveyPageId\"},{\"name\":\"SurveyVersionId\"},{\"name\":\"SystemModstamp\"}],\"object\":\"SurveyQuestion\"}},\"ED_Digest_LoyaltyMemberTier\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CreatedDate\"},{\"name\":\"EffectiveDate\"},{\"name\":\"Id\"},{\"name\":\"LoyaltyMemberId\"},{\"name\":\"LoyaltyTierGroupId\"},{\"name\":\"LoyaltyTierId\"},{\"name\":\"Name\"},{\"name\":\"TierExpirationDate\"}],\"object\":\"LoyaltyMemberTier\"}},\"ED_CE_LoyaltyTierGroup\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"isPrimary_Flag\",\"name\":\"isPrimary_Flag\",\"precision\":10,\"saqlExpression\":\"0\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"ED_Augment_LoyaltyProgram_onto_LoyaltyTierGroup\"]},\"ED_Digest_TransactionJournal\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActivityDate\"},{\"name\":\"CreatedDate\"},{\"name\":\"EndDate\"},{\"name\":\"Id\"},{\"name\":\"JournalDate\"},{\"name\":\"JournalTypeId\"},{\"name\":\"LoyaltyProgramId\"},{\"name\":\"MemberId\"},{\"name\":\"PartnerId\"},{\"name\":\"ProductCategoryId\"},{\"name\":\"ProductId\"},{\"name\":\"Quantity\"},{\"name\":\"ReferredMemberId\"},{\"name\":\"RelatedJournalId\"},{\"name\":\"StartDate\"},{\"name\":\"Status\"},{\"name\":\"TransactionAmount\"}],\"object\":\"TransactionJournal\"}},\"ED_CR_TransactionJournal_DaysBetweenPreviousTransactions\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"daysBetween(toDate(current('Previous_ActivityDate_sec_epoch')),toDate(previous('Previous_ActivityDate_sec_epoch')))\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"DaysBetweenPreviousTransactions\",\"name\":\"DaysBetweenPreviousTransactions\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Previous_ActivityDate\"}],\"partitionBy\":[\"MemberId\"]},\"sources\":[\"ED_CR_TransactionJournal_DaysBetweenCurrentTransactions\"]},\"CX_Digest_SurveySubject\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"Name\"},{\"name\":\"ParentId\"},{\"name\":\"SubjectEntityType\"},{\"name\":\"SubjectId\"},{\"name\":\"SurveyId\"},{\"name\":\"SurveyInvitationId\"},{\"name\":\"SurveyResponseId\"}],\"object\":\"SurveySubject\"}}}}",null]