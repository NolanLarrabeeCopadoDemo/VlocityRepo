{"dataSourceLinksInfo":{"enableAutomaticLinking":false,"excludeRelationships":[],"links":[{"fields":[{"dataSourceName":"ProgramRebateTypeMaster","dataSourceNamespace":"","dataSourceType":"dataset","fieldName":"RebateProgram.Name"},{"dataSourceName":"ProgramRebateTypeBenefitMaster","dataSourceNamespace":"","dataSourceType":"dataset","fieldName":"RebateType.RebateProgram.Name"}],"label":"RebateProgramFaceting","name":"Link_684"}]},"filters":[],"gridLayouts":[{"maxWidth":550,"name":"Default","numColumns":50,"pages":[{"label":"Page 1","name":"7eed5703-a19c-4eae-8c67-ce65fe1ef2c7","navigationHidden":false,"widgets":[{"colspan":48,"column":1,"name":"chart_1","row":14,"rowspan":20,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"text_1","row":11,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"chart_2","row":37,"rowspan":13,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"text_2","row":35,"rowspan":2,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"chart_38","row":63,"rowspan":16,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"container_1","row":51,"rowspan":8,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":4,"borderWidth":8}},{"colspan":48,"column":1,"name":"text_3","row":60,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":12,"column":36,"name":"text_4","row":52,"rowspan":2,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":10,"column":26,"name":"text_5","row":52,"rowspan":2,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":24,"column":2,"name":"text_6","row":52,"rowspan":2,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":12,"column":36,"name":"number_1","row":54,"rowspan":2,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":10,"column":26,"name":"text_7","row":54,"rowspan":2,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":24,"column":2,"name":"text_8","row":54,"rowspan":2,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":24,"column":2,"name":"chart_17","row":56,"rowspan":3,"widgetStyle":{"backgroundColor":"#E6ECF2","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":3,"column":1,"name":"image_2","row":1,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":18,"column":4,"name":"text_9","row":1,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":16,"column":1,"name":"link_4","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"rgb(0, 112, 210)","borderColor":"#E6ECF2","borderEdges":["left","top","bottom"],"borderRadius":0,"borderWidth":2}},{"colspan":16,"column":25,"name":"link_1","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":["left","top","bottom"],"borderRadius":0,"borderWidth":2}},{"colspan":8,"column":17,"name":"text_14","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"rgb(0, 112, 210)","borderColor":"#E6ECF2","borderEdges":["top","bottom","right"],"borderRadius":0,"borderWidth":2}},{"colspan":8,"column":41,"name":"text_13","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":["right","top","bottom"],"borderRadius":0,"borderWidth":2}}]},{"label":"Page 2","name":"b6e89414-7327-4fc6-bd17-098a19833fe7","navigationHidden":true,"widgets":[{"colspan":48,"column":1,"name":"text_1","row":11,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"text_3","row":51,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":3,"column":1,"name":"image_2","row":1,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":18,"column":4,"name":"text_9","row":1,"rowspan":3,"widgetStyle":{"borderEdges":[]}},{"colspan":48,"column":1,"name":"chart_3","row":14,"rowspan":20,"widgetStyle":{"borderEdges":[]}},{"colspan":16,"column":1,"name":"link_2","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":["left","top","bottom"],"borderRadius":0,"borderWidth":2}},{"colspan":16,"column":25,"name":"link_3","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"rgb(0, 112, 210)","borderColor":"#E6ECF2","borderEdges":["left","top","bottom"],"borderRadius":0,"borderWidth":2}},{"colspan":8,"column":17,"name":"text_10","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":["right","top","bottom"],"borderRadius":0,"borderWidth":2}},{"colspan":8,"column":41,"name":"text_11","row":5,"rowspan":5,"widgetStyle":{"backgroundColor":"rgb(0, 112, 210)","borderColor":"#E6ECF2","borderEdges":["top","bottom","right"],"borderRadius":0,"borderWidth":2}},{"colspan":48,"column":1,"name":"chart_4","row":54,"rowspan":16,"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":48,"column":1,"name":"chart_5","row":37,"rowspan":13,"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1}},{"colspan":48,"column":1,"name":"text_16","row":35,"rowspan":2,"widgetStyle":{"borderEdges":[]}}]}],"rowHeight":"fine","selectors":[],"style":{"alignmentX":"left","alignmentY":"top","backgroundColor":"#FFFFFF","cellSpacingX":0,"cellSpacingY":0,"fit":"original","gutterColor":"#C5D3E0"},"version":1.0}],"layouts":[],"steps":{"Date_Filter_1":{"broadcastFacet":true,"groups":[],"numbers":[],"query":"q = load \"MFG_SalesAgreementProductSchedule\";\nq = filter q by {{coalesce(cell(Id_1.result, 0, \"Id\"),\"-\").asEquality(\"SalesAgreementProduct.SalesAgreementId\")}};\nq = group q by 'SalesAgreementProduct.SalesAgreementId';\nq = foreach q generate 'SalesAgreementProduct.SalesAgreementId' as 'SalesAgreementProduct.SalesAgreementId',first('SalesAgreementProduct.SalesAgreement.StartDate') as 'SalesAgreementProduct.SalesAgreement.StartDate', first('SalesAgreementProduct.SalesAgreement.EndDate') as 'SalesAgreementProduct.SalesAgreement.EndDate', min('SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch') as 'Min', min(min('SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')) over ([..] partition by all ) as 'Total_Min', max('SalesAgreementProduct.SalesAgreement.EndDate_sec_epoch') as 'Max',max(max('SalesAgreementProduct.SalesAgreement.EndDate_sec_epoch')) over ([..] partition by all ) as 'Totat_Max', sum(unique('SalesAgreementProduct.SalesAgreementId')) over ([..] partition by all ) as 'Total_Count';\nq = foreach q generate 'SalesAgreementProduct.SalesAgreementId' as 'SalesAgreementProduct.SalesAgreementId',first('SalesAgreementProduct.SalesAgreement.StartDate') as 'SalesAgreementProduct.SalesAgreement.StartDate', first('SalesAgreementProduct.SalesAgreement.EndDate') as 'SalesAgreementProduct.SalesAgreement.EndDate', case when 'Total_Count'> 1 then min('Total_Min')*1000 else min('Min')*1000 end as 'Min', case when 'Total_Count'> 1 then 'Totat_Max'*1000 else 'Max'*1000 end as 'Max';","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"single","start":"[]","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Tiers":{"broadcastFacet":true,"groups":[],"numbers":[],"query":"all_benefit_types = load \"ProgramRebateTypeBenefitMaster\";\r\nall_benefit_types = filter all_benefit_types by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster4 = load \"ProgramRebateTypeMaster\";\r\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'RebateProgram.Name' in  [\"{{coalesce(cell(Rebate_Program.selection, 0, \"RebateProgram.Name\"),cell(Rebate_Program.result, 0, \"RebateProgram.Name\"),\"-\").asObject()}}\"];\r\nProgramRebateTypeMaster4 = group ProgramRebateTypeMaster4  by ('Id', 'InclusionFilters.ValuesMultiValue','RebateProgram.Name');\r\nall_benefit_types = filter all_benefit_types by 'RebateType.RebateProgram.Name' in [\"{{coalesce(cell(Rebate_Program.selection, 0, \"RebateProgram.Name\"),cell(Rebate_Program.result, 0, \"RebateProgram.Name\"),\"-\").asObject()}}\"];\r\nall_benefit_types = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name','Id' as 'Id', 'Name' as 'Name', number_to_string('MinimumQualifyingValue',\"#.0#\") as 'MinimumQualifyingValue_str', 'MinimumQualifyingValue', number_to_string('MaximumQualifyingValue',\"#.0#\") as 'MaximumQualifyingValue_str', 'MaximumQualifyingValue', 'BenefitValue', 'RebateType.RebateMeasureType';\r\nall_benefit_types = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name','Id' as 'Id', 'Name' as 'Name', 'MaximumQualifyingValue', case when len('MaximumQualifyingValue_str') > 5 then (number_to_string('MaximumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MaximumQualifyingValue_str' end as 'MaximumQualifyingValue_str', 'MinimumQualifyingValue', case when len('MinimumQualifyingValue_str') > 5 then (number_to_string('MinimumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MinimumQualifyingValue_str' end as 'MinimumQualifyingValue_str', 'BenefitValue', 'RebateType.RebateMeasureType', case when 'RebateType.RebateMeasureType'==\"PercentageOfRevenue\" then \"%\" when 'RebateType.RebateMeasureType'==\"Custom\" then \"no units\" else \"$\" end as 'BenefitUnit';\r\nall_benefit_types = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name', 'Id' as 'Id', 'Name' as 'Name', 'MinimumQualifyingValue_str'+\" - \"+'MaximumQualifyingValue_str' as 'Tiers', 'BenefitValue', 'BenefitUnit','MinimumQualifyingValue';\r\nresult = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name' as 'RebateType.RebateProgram.Name', 'Id' as 'ProgramRebateTypeBenefitId', first(all_benefit_types.'Tiers') as 'Tiers', first(all_benefit_types.'BenefitUnit') as 'BenefitUnit', case when first(all_benefit_types.'BenefitUnit') == \"%\" then \"%\" else null end as 'BenefitUnit_suffix', case when first(all_benefit_types.'BenefitUnit') == \"$\" then \"$\" else null end as 'BenefitUnit_prefix',\r\ncoalesce(sum(all_benefit_types.'BenefitValue'),0) as 'Benefit Value','MinimumQualifyingValue';\r\nresult = group result by ('ProgramRebateTypeId','ProductId' ,'RebateType.RebateProgram.Name','ProgramRebateTypeBenefitId','Tiers');\r\n--result = foreach result generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId', 'Tiers' as 'Tiers',sum('Benefit Value') as 'Benefit Multiplier';\r\nresult1 = cogroup result by 'ProgramRebateTypeId' left , ProgramRebateTypeMaster4 by 'Id';\r\nresult1 = foreach result1 generate ProgramRebateTypeMaster4.'InclusionFilters.ValuesMultiValue' as 'InclusionFilters.ValuesMultiValue',  result.'ProductId' as 'ProductId', ProgramRebateTypeMaster4.'RebateProgram.Name' as 'RebateProgram.Name', result.'RebateType.RebateProgram.Name' as 'RebateType.RebateProgram.Name' ,result.'ProgramRebateTypeBenefitId' as 'ProgramRebateTypeBenefitId' , result.'Tiers' as 'Tiers', sum(result.'Benefit Value') as 'Benefit Multiplier';\r\nresult1 = filter result1 by ( 'ProductId' is null || 'ProductId' == \"{{coalesce(cell(Bubble_Chart.selection, 0, \"SalesAgreementProduct.ProductId\"),cell(Bubble_Chart.result,0,\"SalesAgreementProduct.ProductId\"),\"-\").asString()}}\");\r\nresult1 = foreach result1 generate 'Tiers' as 'Tiers',sum('Benefit Multiplier') as 'Benefit Multiplier';","receiveFacetSource":{"mode":"include","steps":["Rebate_Program","Bubble_Chart","Current_Qualifier_Value"]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Current_Tier":{"broadcastFacet":true,"groups":[],"label":"Current_Tier","numbers":[],"query":"q = load \"ProgramRebateTypePayoutSourceMaster\";\nq = filter q by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nq = filter q by 'MemberPayout.Member.Account.Name'== \"{{cell(Account_Name_2.selection, 0, \"Account.Name\").asString()}}\";\nq = filter q by 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result, 0, \"Max\"),0).asObject()}};\nq = filter q by 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result, 0, \"Min\"),0).asObject()}};\nall_payout_sources = filter q by 'MemberPayout.PayoutPeriods.RebateProgram.Name' in [\"{{cell(Rebate_Program.selection, 0, \"RebateProgram.Name\").asString()}}\"];\nall_payout_sources = filter all_payout_sources by 'Product.Name' in [\"{{cell(Toggle_1.selection, 0, \"Product Name\").asString()}}\"];\nall_payout_sources = foreach all_payout_sources generate 'MemberPayout.PayoutPeriods.Name','RebateType.BenefitQualifierField','BenefitQualifierValue', 'RebateTypeBenefit.Id', 'RebateTypeBenefit.Name', number_to_string('RebateTypeBenefit.MinimumQualifyingValue',\"#.0#\") as 'MinimumQualifyingValue_str', 'RebateTypeBenefit.MinimumQualifyingValue', number_to_string('RebateTypeBenefit.MaximumQualifyingValue',\"#.0#\") as 'MaximumQualifyingValue_str', 'RebateTypeBenefit.MaximumQualifyingValue','Product.PriceEntry.UnitPrice';\nall_payout_sources = foreach all_payout_sources generate 'MemberPayout.PayoutPeriods.Name', 'RebateTypeBenefit.Id','RebateType.BenefitQualifierField', 'RebateTypeBenefit.Name','BenefitQualifierValue', 'RebateTypeBenefit.MaximumQualifyingValue', case when len('MaximumQualifyingValue_str') > 5 then (number_to_string('RebateTypeBenefit.MaximumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MaximumQualifyingValue_str' end as 'MaximumQualifyingValue_str', 'RebateTypeBenefit.MinimumQualifyingValue', case when len('MinimumQualifyingValue_str') > 5 then (number_to_string('RebateTypeBenefit.MinimumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MinimumQualifyingValue_str' end as 'MinimumQualifyingValue_str', 'Product.PriceEntry.UnitPrice';\nall_payout_sources = foreach all_payout_sources generate 'MemberPayout.PayoutPeriods.Name', 'RebateTypeBenefit.Id','RebateType.BenefitQualifierField', 'RebateTypeBenefit.Name', 'MinimumQualifyingValue_str'+\" - \"+'MaximumQualifyingValue_str' as 'Tiers','BenefitQualifierValue', 'Product.PriceEntry.UnitPrice';\nresult = group  all_payout_sources by ('MemberPayout.PayoutPeriods.Name', 'RebateTypeBenefit.Id', 'Tiers', 'RebateType.BenefitQualifierField');\nresult = foreach result generate 'MemberPayout.PayoutPeriods.Name',coalesce('Tiers',\"-\") as 'Tiers','RebateType.BenefitQualifierField' as 'RebateType.BenefitQualifierField',  sum('BenefitQualifierValue') as 'BenefitQualifierValue', sum('Product.PriceEntry.UnitPrice') as 'UnitPrice';","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Progress_To_Next":{"broadcastFacet":true,"groups":[],"label":"Progress_To_Next","numbers":[],"query":"all_benefit_types = load \"ProgramRebateTypeBenefitMaster\";\nall_benefit_types = filter all_benefit_types by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nall_benefit_types = filter all_benefit_types by 'RebateType.RebateProgram.Name' == \"{{cell(Rebate_Program.selection, 0, \"RebateProgram.Name\").asString()}}\";\nall_benefit_types = filter all_benefit_types by 'ProductId' == \"{{cell(Bubble_Chart.selection, 0, \"SalesAgreementProduct.ProductId\").asString()}}\";\r\nall_benefit_types = foreach all_benefit_types generate 'Id' as 'Id', 'Name' as 'Name', number_to_string('MinimumQualifyingValue',\"#.0#\") as 'MinimumQualifyingValue_str', 'MinimumQualifyingValue', number_to_string('MaximumQualifyingValue',\"#.0#\") as 'MaximumQualifyingValue_str', 'MaximumQualifyingValue', 'BenefitValue', 'RebateType.RebateMeasureType','RebateType.BenefitQualifierField';\r\nall_benefit_types = foreach all_benefit_types generate 'Id' as 'Id', 'Name' as 'Name', 'MaximumQualifyingValue', case when len('MaximumQualifyingValue_str') > 5 then (number_to_string('MaximumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MaximumQualifyingValue_str' end as 'MaximumQualifyingValue_str', 'MinimumQualifyingValue', case when len('MinimumQualifyingValue_str') > 5 then (number_to_string('MinimumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MinimumQualifyingValue_str' end as 'MinimumQualifyingValue_str', 'BenefitValue', 'RebateType.RebateMeasureType', case when 'RebateType.RebateMeasureType'==\"PercentageOfRevenue\" then \"%\" when 'RebateType.RebateMeasureType'==\"Custom\" then \"no units\" else \"$\" end as 'BenefitUnit','RebateType.BenefitQualifierField';\r\nall_benefit_types = foreach all_benefit_types generate 'Id' as 'Id', 'Name' as 'Name', 'MinimumQualifyingValue_str'+\" - \"+'MaximumQualifyingValue_str' as 'Tiers','RebateType.BenefitQualifierField', 'BenefitValue', 'BenefitUnit','MinimumQualifyingValue','MaximumQualifyingValue';\r\nall_benefit_types = filter all_benefit_types by 'Tiers' != \"{{cell(Current_Tier.result, 0, \"Tiers\").asString()}}\";\r\nresult = foreach all_benefit_types generate 'Id' as 'ProgramRebateTypeBenefitId', first(all_benefit_types.'Tiers') as 'Tiers','RebateType.BenefitQualifierField', 'MinimumQualifyingValue','MaximumQualifyingValue',first(all_benefit_types.'BenefitUnit') as 'BenefitUnit', case when first(all_benefit_types.'BenefitUnit') == \"%\" then \"%\" else null end as 'BenefitUnit_suffix', case when first(all_benefit_types.'BenefitUnit') == \"$\" then \"$\" else null end as 'BenefitUnit_prefix',\r\ncoalesce(sum(all_benefit_types.'BenefitValue'),0) as 'Benefit Value';\r\nresult = foreach result generate 'Tiers' as 'Tiers','RebateType.BenefitQualifierField','MinimumQualifyingValue','MaximumQualifyingValue', {{coalesce(cell(Current_Tier.result, 0, \"BenefitQualifierValue\"),0).asObject()}} as 'Current_Benifit_Qualifier','MinimumQualifyingValue' - {{coalesce(cell(Current_Tier.result, 0, \"BenefitQualifierValue\"),0).asObject()}} as 'Min_Current_DIfference';\r\nresult = group result by 'Tiers';\r\nresult = foreach result generate 'Tiers' as 'Tiers',first('RebateType.BenefitQualifierField') as 'RebateType.BenefitQualifierField', sum('MinimumQualifyingValue') as 'MinimumQualifyingValue' ,sum('MaximumQualifyingValue') as 'MaximumQualifyingValue',sum('Current_Benifit_Qualifier') as 'Current_Benifit_Qualifier', case when sum(sum('Current_Benifit_Qualifier')) over ([..] partition by all) == 0 then min(sum('MinimumQualifyingValue')) over ([..] partition by all) else  sum('MinimumQualifyingValue') - sum('Current_Benifit_Qualifier') end as 'Min_Current_DIfference';\r\nresult = group result by 'Tiers';\r\nresult = foreach result generate 'Tiers' as 'Tiers',first('RebateType.BenefitQualifierField') as 'RebateType.BenefitQualifierField', sum('MinimumQualifyingValue') as 'MinimumQualifyingValue' ,sum('MaximumQualifyingValue') as 'MaximumQualifyingValue',sum('Current_Benifit_Qualifier') as 'Current_Benifit_Qualifier', case when sum('Current_Benifit_Qualifier') > sum('Min_Current_DIfference') then 0 else  sum('MinimumQualifyingValue') - sum('Current_Benifit_Qualifier') end as 'Min_Current_DIfference';\r\nresult = filter result by 'Min_Current_DIfference' > 0 ;\r\nresult = group result by 'Tiers';\r\nresult = foreach result generate 'Tiers' as 'Tiers', first('RebateType.BenefitQualifierField') as 'RebateType.BenefitQualifierField',sum('MinimumQualifyingValue') as 'MinimumQualifyingValue' ,sum('MaximumQualifyingValue') as 'MaximumQualifyingValue',sum('Current_Benifit_Qualifier') as 'Current_Benifit_Qualifier', case when first('RebateType.BenefitQualifierField') == \"TotalTransactionAmount\" then sum('Min_Current_DIfference')/{{coalesce(cell(Current_Tier.result, 0, \"UnitPrice\"),1).asObject()}} else sum('Min_Current_DIfference') end as 'Progress_To_Next_Tier', min( sum('Min_Current_DIfference')) over([..] partition by all)  as 'Min';\r\nresult = filter result by 'Progress_To_Next_Tier' == 'Min' ;","receiveFacetSource":{"mode":"include","steps":["Bubble_Chart","Rebate_Program","Tiers","Current_Qualifier_Value"]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Product_Filter_1":{"broadcastFacet":true,"groups":[],"label":"Product_Filter_withoutIncentives","numbers":[],"query":"MFG_SalesAgreementProductSchedule4 = load \"MFG_SalesAgreementProductSchedule\";\nProgramRebateTypeMaster4 = load \"ProgramRebateTypeMaster\";\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nMFG_SalesAgreementProductSchedule4 = filter MFG_SalesAgreementProductSchedule4 by  {{cell(Account_Name_2.selection, 0, \"Account.Name\").asEquality(\"SalesAgreementProduct.SalesAgreement.Account.Name\")}};\nMFG_SalesAgreementProductSchedule4 = filter MFG_SalesAgreementProductSchedule4 by  {{coalesce(cell(Id_1.result, 0, \"Id\"),\"-\").asEquality(\"SalesAgreementProduct.SalesAgreementId\")}} ;\nresult = cogroup MFG_SalesAgreementProductSchedule4 by  'SalesAgreementProduct.ProductId' left, ProgramRebateTypeMaster4 by 'InclusionFilters.ValuesMultiValue';\nresult = foreach result generate MFG_SalesAgreementProductSchedule4.'SalesAgreementProduct.ProductId' as 'SalesAgreementProduct.ProductId', first(MFG_SalesAgreementProductSchedule4.'SalesAgreementProduct.Name') as 'Product Name', first(ProgramRebateTypeMaster4.'RebateProgram.Name') as 'Program Name', case when first(ProgramRebateTypeMaster4.'RebateProgram.Name') is not null then \"Products With Incentives\" else \"Products Without Incentives\" end as 'Incentive';\r\nresult = filter result by 'Incentive' == \"Products Without Incentives\" ","receiveFacetSource":{"mode":"include","steps":["Toggle"]},"selectMode":"singlerequired","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"borderColor":"#e0e5ee","borderWidth":1,"cell":{"backgroundColor":"#ffffff","fontColor":"#16325c","fontSize":12},"columnProperties":{},"columns":[],"customBulkActions":[],"header":{"backgroundColor":"#f4f6f9","fontColor":"#16325c","fontSize":12},"innerMajorBorderColor":"#a8b7c7","innerMinorBorderColor":"#e0e5ee","interactions":[],"maxColumnWidth":300,"minColumnWidth":40,"mode":"variable","numberOfLines":1,"pivoted":false,"showActionMenu":true,"totals":true,"verticalPadding":8},"type":"table"}},"Rebate_Program":{"broadcastFacet":true,"groups":[],"label":"Rebate_Program","numbers":[],"query":"ProgramRebateTypeMaster = load \"ProgramRebateTypeMaster\";\r\nProgramRebateTypeMaster = filter ProgramRebateTypeMaster by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster = group ProgramRebateTypeMaster by ('InclusionFilters.ValuesMultiValue','RebateProgram.Name');\r\nProductMaster = load \"ProductMaster\";all_payout_sources = load \"ProgramRebateTypePayoutSourceMaster\";all_payout_sources = filter all_payout_sources by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nall_payout_sources = filter all_payout_sources by 'MemberPayout.Member.Account.Name' == \"{{cell(Account_Name_2.result, 0, \"Account.Name\").asString()}}\";\r\ncurrent_valid_payout_sources = filter all_payout_sources by 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000;\r\ncurrent_valid_payout_sources = filter current_valid_payout_sources by 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000;\r\nStart_Current = foreach current_valid_payout_sources generate 'Product.Id' as 'Product.Id', {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 as 'Start', {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 as 'End', 'Id' as 'Id', 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' as 'Start Date', 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' as 'End Date', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),\"yyyy\") else date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),\"yyyy\") end as 'Date_Year', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),\"MM\") else date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),\"MM\") end as 'Date_Month', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' else 'AggregateObject.TotalTransactionAmount' end as 'TotalTransactionAmount', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 'FinalRebateAmount' end as 'RebateAmount', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' else 'RebateAmount' end as 'RebateBeforeAdjustment', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' else 'AggregateObject.TotalQuantity' end as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount';\r\nEnd_Current = foreach current_valid_payout_sources generate  'Product.Id' as 'Product.Id',{{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 as 'Start', {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 as 'End', 'Id' as 'Id', 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' as 'Start Date', 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' as 'End Date', case when ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'),\"yyyy\") else  date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000),\"yyyy\") end as 'Date_Year', case when ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'),\"MM\") else  date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000),\"MM\") end as 'Date_Month', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyTotalTransactionAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' else 0 end as 'TotalTransactionAmount', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 0 end as 'RebateAmount', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyRebateAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' else 0 end as 'RebateBeforeAdjustment', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyQuantity' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' else 0 end as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount';\r\nDataForFill_Current = union Start_Current, End_Current;\r\nDataForFill_Current = foreach DataForFill_Current generate  'Product.Id' as 'Product.Id','Id' as 'Id', 'Date_Year' as 'Date_Year', 'Date_Month' as 'Date_Month','Start' as 'Start', 'End' as 'End', 'Start Date' as 'Start Date', 'End Date' as 'End Date', 'TotalTransactionAmount' as 'TotalTransactionAmount', 'RebateAmount' as 'RebateAmount', 'TotalQuantity' as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount', 'RebateBeforeAdjustment' as 'RebateBeforeAdjustment';\r\nFilledData_Current = fill DataForFill_Current by (dateCols=('Date_Year', 'Date_Month', \"Y-M\"), partition='Id');\r\nFilledData_Current = group FilledData_Current by ('Id', 'Date_Year', 'Date_Month','Product.Id');\r\nFilledData_Current = foreach FilledData_Current generate 'Id', 'Date_Year', 'Date_Month','Product.Id', date_to_epoch(toDate('Date_Year'+\"-\"+'Date_Month'+\"-01\",\"yyyy-MM-dd\")) as 'Date', first('Start') as 'Start', min(first('Start')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'StartFilter', first('End') as 'End', min(first('End')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'EndFilter',  min(first('Start Date')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'Start Date', max(first('End Date')) over ([..] partition by 'Id' ) as 'End Date',  sum('TotalTransactionAmount') as 'TotalTransactionAmount', min(first('DailyTotalTransactionAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyTotalTransactionAmount', sum('RebateAmount') as 'RebateAmount', min(first('DailyFinalRebateAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyFinalRebateAmount', sum('RebateBeforeAdjustment') as 'RebateBeforeAdjustment', min(first('DailyRebateAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyRebateAmount', sum('TotalQuantity') as 'TotalQuantity', min(first('DailyQuantity'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyQuantity';\r\nFilledData_Current = filter FilledData_Current by coalesce('Start',0) != 0 || ('Date' > 'StartFilter' && 'Date' > 'Start Date' && 'Date' < 'End Date' && 'Date' < 'EndFilter');\r\nFilledData_Current = foreach FilledData_Current generate 'Product.Id' as 'Product.Id','Id', 'Date_Year', 'Date_Month', (case when 'TotalTransactionAmount' is null then month_days(toDate('Date'))*'DailyTotalTransactionAmount' else 'TotalTransactionAmount' end) as 'TotalTransactionAmount', (case when 'RebateAmount' is null then month_days(toDate('Date'))*'DailyFinalRebateAmount' else 'RebateAmount' end) as 'RebateAmount', (case when 'RebateBeforeAdjustment' is null then month_days(toDate('Date'))*'DailyRebateAmount' else 'RebateBeforeAdjustment' end) as 'RebateBeforeAdjustment', (case when 'TotalQuantity' is null then month_days(toDate('Date'))*'DailyQuantity' else 'TotalQuantity' end) as 'TotalQuantity';\r\nFilledData_Current = group FilledData_Current by 'Product.Id';\r\nFilledData_Current = foreach FilledData_Current generate 'Product.Id' as 'Product.Id',\r\nsum('RebateAmount')/ sum('TotalTransactionAmount') as 'Avg Effective Rebate';\r\nResult = cogroup ProgramRebateTypeMaster  by 'InclusionFilters.ValuesMultiValue' left,ProductMaster by 'Id' left,FilledData_Current by 'Product.Id';\r\nResult = foreach Result generate first(ProductMaster.'Name') as 'Name', ProgramRebateTypeMaster.'InclusionFilters.ValuesMultiValue' as 'ProductId',ProgramRebateTypeMaster.'RebateProgram.Name' as 'RebateProgram.Name', sum(FilledData_Current.'Avg Effective Rebate') as 'Avg Effective Rebate';\r\nResult = filter Result by 'Name' is not null;\r\nResult = filter Result by 'Name' == \"{{coalesce(cell(Bubble_Chart.selection, 0, \"SalesAgreementProduct.Name\"),cell(Bubble_Chart.result,0,\"SalesAgreementProduct.Name\"),\"-\").asString()}}\";\r\nResult = foreach Result generate  'RebateProgram.Name' as 'RebateProgram.Name', coalesce('Avg Effective Rebate',0) as 'Avg Effective Rebate';\r\nResult = order Result by 'Avg Effective Rebate' desc;","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"singlerequired","start":"[]","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Id_1":{"broadcastFacet":true,"groups":[],"label":"Id_1","numbers":[],"query":"q = load \"MFG_SalesAgreement\";\nq = group q by 'Id';\nq = foreach q generate 'Id' as 'Id', count() as 'count';\nq = order q by 'Id' asc;","receiveFacetSource":{"mode":"all","steps":[]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Toggle_1":{"broadcastFacet":true,"groups":[],"label":"Product_Filter_withIncentives","numbers":[],"query":"MFG_SalesAgreementProductSchedule4 = load \"MFG_SalesAgreementProductSchedule\";\nProgramRebateTypeMaster4 = load \"ProgramRebateTypeMaster\";\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nMFG_SalesAgreementProductSchedule4 = filter MFG_SalesAgreementProductSchedule4 by  {{cell(Account_Name_2.selection, 0, \"Account.Name\").asEquality(\"SalesAgreementProduct.SalesAgreement.Account.Name\")}};\nMFG_SalesAgreementProductSchedule4 = filter MFG_SalesAgreementProductSchedule4 by  {{coalesce(cell(Id_1.result, 0, \"Id\"),\"-\").asEquality(\"SalesAgreementProduct.SalesAgreementId\")}} ;\nresult = cogroup MFG_SalesAgreementProductSchedule4 by  'SalesAgreementProduct.ProductId' left, ProgramRebateTypeMaster4 by 'InclusionFilters.ValuesMultiValue';\nresult = foreach result generate MFG_SalesAgreementProductSchedule4.'SalesAgreementProduct.ProductId' as 'SalesAgreementProduct.ProductId', first(MFG_SalesAgreementProductSchedule4.'SalesAgreementProduct.Name') as 'Product Name', first(ProgramRebateTypeMaster4.'RebateProgram.Name') as 'Program Name', case when first(ProgramRebateTypeMaster4.'RebateProgram.Name') is not null then \"Products With Incentives\" else \"Products Without Incentives\" end as 'Incentive';\r\nresult = filter result by 'Incentive' == \"Products With Incentives\" ","receiveFacetSource":{"mode":"include","steps":["Toggle"]},"selectMode":"singlerequired","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"borderColor":"#e0e5ee","borderWidth":1,"cell":{"backgroundColor":"#ffffff","fontColor":"#16325c","fontSize":12},"columnProperties":{},"columns":[],"customBulkActions":[],"header":{"backgroundColor":"#f4f6f9","fontColor":"#16325c","fontSize":12},"innerMajorBorderColor":"#a8b7c7","innerMinorBorderColor":"#e0e5ee","interactions":[],"maxColumnWidth":300,"minColumnWidth":40,"mode":"variable","numberOfLines":1,"pivoted":false,"showActionMenu":true,"totals":true,"verticalPadding":8},"type":"table"}},"Bubble_Chart_1":{"broadcastFacet":true,"groups":[],"label":"Bubble_Chart_1","numbers":[],"query":"q = load \"MFG_SalesAgreementProductSchedule\";\nq = filter q by {{coalesce(column(Product_Filter_1.result, [\"Product Name\"]), \"-\").asEquality(\"SalesAgreementProduct.Name\")}};\n--q = filter q by 'SalesAgreementProduct.SalesAgreement.StatusCode' == \"Activated\";\nresult = group q by ('SalesAgreementProduct.SalesAgreement.Name', 'SalesAgreementProduct.Name');\nresult = foreach result generate q.'SalesAgreementProduct.SalesAgreement.Name' as 'SalesAgreementProduct.SalesAgreement.Name',q.'SalesAgreementProduct.Name' as 'SalesAgreementProduct.Name',first('SalesAgreementProduct.ProductId') as 'SalesAgreementProduct.ProductId', sum(q.'DerivedPlannedAmount') as 'Planned_Revenue', sum(q.'DerivedActualAmount') as 'B', daysBetween(toDate(first(q.'SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')),now()) + 1 as '# Active Days', ((daysBetween(toDate(first(q.'SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')),now()) + 1) * sum(q.'DerivedPlannedAmount'))/((daysBetween(toDate(first(q.'SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')),toDate(first(q.'SalesAgreementProduct.SalesAgreement.EndDate_sec_epoch'))) + 1)) as 'Planned Amount Till Date';\nresult = foreach result generate 'SalesAgreementProduct.SalesAgreement.Name','SalesAgreementProduct.Name' as 'SalesAgreementProduct.Name', first('SalesAgreementProduct.ProductId') as 'SalesAgreementProduct.ProductId','Planned_Revenue', 'B', '# Active Days', 'B'/'Planned Amount Till Date' as 'Compliance', 'Planned Amount Till Date'-'B' as 'Revenue Leak', 'Planned Amount Till Date' as 'Planned Amount Till Date';\nresult = foreach result generate 'SalesAgreementProduct.Name' as 'SalesAgreementProduct.Name',first('SalesAgreementProduct.ProductId') as 'SalesAgreementProduct.ProductId','Planned_Revenue' as 'Planned_Revenue', 'Compliance' as 'Compliance';","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"singlerequired","start":"[]","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"radiusRatio":5,"columnMap":{"r":[],"x":["Planned_Revenue"],"y":["Compliance"],"trellis":[],"plots":["SalesAgreementProduct.Name"]},"showActionMenu":true,"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"x":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"visualizationType":"scatter","y":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"theme":"wave","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"applyConditionalFormatting":true},"type":"chart"}},"Toggle":{"broadcastFacet":true,"groups":[],"label":"Toggle","numbers":[],"query":"MFG_SalesAgreementProductSchedule4 = load \"MFG_SalesAgreementProductSchedule\";\r\nMFG_SalesAgreementProductSchedule4 = filter MFG_SalesAgreementProductSchedule4 by  'SalesAgreementProduct.SalesAgreement.Account.Name' == \"{{cell(Account_Name_2.selection, 0, \"Account.Name\").asString()}}\";\r\nMFG_SalesAgreementProductSchedule4 = filter MFG_SalesAgreementProductSchedule4 by {{coalesce(cell(Id_1.result, 0, \"Id\"),\"-\").asEquality(\"SalesAgreementProduct.SalesAgreementId\")}};\r\nProgramRebateTypeMaster4 = load \"ProgramRebateTypeMaster\";\r\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster4 = group ProgramRebateTypeMaster4 by ('RebateProgram.Name', 'InclusionFilters.ValuesMultiValue');\r\nRebateProgramMemberMaster4 = load \"RebateProgramMemberMaster\";\r\nRebateProgramMemberMaster4 = filter RebateProgramMemberMaster4 by 'Account.Name' == \"{{cell(Account_Name_2.selection, 0, \"Account.Name\").asString()}}\";\r\nresult1 = cogroup RebateProgramMemberMaster4 by 'RebateProgram.Name' left, ProgramRebateTypeMaster4 by 'RebateProgram.Name';\r\nresult1 = foreach result1 generate RebateProgramMemberMaster4.'RebateProgram.Name' as 'ProgramName', ProgramRebateTypeMaster4.'InclusionFilters.ValuesMultiValue' as 'ProductId';\r\nresult1 = filter result1 by 'ProductId' is not null;\r\nfinal_Result = cogroup MFG_SalesAgreementProductSchedule4 by 'SalesAgreementProduct.ProductId' left, result1  by 'ProductId';\r\nfinal_Result = foreach final_Result generate first(MFG_SalesAgreementProductSchedule4.'SalesAgreementProduct.Name') as 'Product Name',first(result1.'ProgramName') as 'RebateProgram', case when first(result1.'ProgramName') is not null then \"Products With Incentives\" else \"Products Without Incentives\" end as 'Incentive';\r\nresult = group final_Result by 'Incentive';\r\nresult = foreach result generate 'Incentive' as 'Incentive', sum(count()) over ([..] partition by 'Incentive') as 'Incentive_count', sum(unique('Incentive')) over ([..] partition by all ) as 'Sum_UniqueCount';\r\nresult = foreach result generate 'Incentive' as 'Incentive', coalesce(sum('Incentive_count'),0) as 'Incentive_count','Sum_UniqueCount'  as 'Sum_UniqueCount';\r\nresult1 = foreach result generate case when 'Sum_UniqueCount' == 1 && 'Incentive' == \"Products With Incentives\" then \"Products Without Incentives\" else \"Products With Incentives\" end as 'Incentive' , 0 as 'Incentive_count';\r\nmain_Result = union result , result1;\r\nmain_Result = group main_Result  by 'Incentive';\r\nmain_Result = foreach main_Result generate 'Incentive' as 'Incentive',coalesce(sum('Incentive_count'),0) as 'Incentive_count';\r\nmain_Result = order main_Result by 'Incentive' asc;","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"singlerequired","start":"[]","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"borderColor":"#e0e5ee","borderWidth":1,"cell":{"backgroundColor":"#ffffff","fontColor":"#16325c","fontSize":12},"columnProperties":{},"columns":[],"customBulkActions":[],"header":{"backgroundColor":"#f4f6f9","fontColor":"#16325c","fontSize":12},"innerMajorBorderColor":"#a8b7c7","innerMinorBorderColor":"#e0e5ee","interactions":[],"maxColumnWidth":300,"minColumnWidth":40,"mode":"variable","numberOfLines":1,"pivoted":false,"showActionMenu":true,"totals":true,"verticalPadding":8},"type":"table"}},"Bubble_Chart":{"broadcastFacet":true,"groups":[],"label":"Bubble_Chart","numbers":[],"query":"q = load \"MFG_SalesAgreementProductSchedule\";\nq = filter q by {{coalesce(column(Toggle_1.result, [\"Product Name\"]), \"-\").asEquality(\"SalesAgreementProduct.Name\")}};\n--q = filter q by 'SalesAgreementProduct.SalesAgreement.StatusCode' == \"Activated\";\nresult = group q by ('SalesAgreementProduct.SalesAgreement.Name', 'SalesAgreementProduct.Name');\nresult = foreach result generate q.'SalesAgreementProduct.SalesAgreement.Name' as 'SalesAgreementProduct.SalesAgreement.Name',q.'SalesAgreementProduct.Name' as 'SalesAgreementProduct.Name',first('SalesAgreementProduct.ProductId') as 'SalesAgreementProduct.ProductId', sum(q.'DerivedPlannedAmount') as 'Planned_Revenue', sum(q.'DerivedActualAmount') as 'B', daysBetween(toDate(first(q.'SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')),now()) + 1 as '# Active Days', ((daysBetween(toDate(first(q.'SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')),now()) + 1) * sum(q.'DerivedPlannedAmount'))/((daysBetween(toDate(first(q.'SalesAgreementProduct.SalesAgreement.StartDate_sec_epoch')),toDate(first(q.'SalesAgreementProduct.SalesAgreement.EndDate_sec_epoch'))) + 1)) as 'Planned Amount Till Date';\nresult = foreach result generate 'SalesAgreementProduct.SalesAgreement.Name','SalesAgreementProduct.Name' as 'SalesAgreementProduct.Name', first('SalesAgreementProduct.ProductId') as 'SalesAgreementProduct.ProductId','Planned_Revenue', 'B', '# Active Days', 'B'/'Planned Amount Till Date' as 'Compliance', 'Planned Amount Till Date'-'B' as 'Revenue Leak', 'Planned Amount Till Date' as 'Planned Amount Till Date';\nresult = foreach result generate 'SalesAgreementProduct.Name' as 'SalesAgreementProduct.Name',first('SalesAgreementProduct.ProductId') as 'SalesAgreementProduct.ProductId','Planned_Revenue' as 'Planned_Revenue', 'Compliance' as 'Compliance';","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"singlerequired","start":"[]","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"radiusRatio":5,"columnMap":{"r":[],"x":["Planned_Revenue"],"y":["Compliance"],"trellis":[],"plots":["SalesAgreementProduct.Name"]},"showActionMenu":true,"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"x":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"visualizationType":"scatter","y":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"theme":"wave","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"applyConditionalFormatting":true},"type":"chart"}},"Payouts":{"broadcastFacet":true,"groups":[],"label":"Payouts","numbers":[],"query":"all_payout_sources = load \"ProgramRebateTypePayoutSourceMaster\";\r\nall_payout_sources = filter all_payout_sources by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nall_payout_sources = filter all_payout_sources by 'MemberPayout.Status' != \"Rejected\";\r\nall_payout_sources = filter all_payout_sources by {{cell(Account_Name_2.selection, 0, \"Account.Name\").asEquality(\"MemberPayout.Member.Account.Name\")}};\r\ncurrent_valid_payout_sources = filter all_payout_sources by 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000;\r\ncurrent_valid_payout_sources = filter current_valid_payout_sources by 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000;\r\nStart_Current = foreach current_valid_payout_sources generate {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 as 'Start',\r\n'MemberPayout.Status' as 'MemberPayout.Status' ,(case when 'MemberPayout.Status' == \"Approved\" then 'DailyFinalRebateAmount' else 0 end) as 'DailyFinalRebateAmount_Approved', (case when 'MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\"  then 'DailyFinalRebateAmount' else 0 end ) as 'DailyFinalRebateAmount_UnderReview',\r\n {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 as 'End', 'Id' as 'Id', 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' as 'Start Date', 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' as 'End Date', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),\"yyyy\") else date_to_string(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),\"yyyy\") end as 'Date_Year', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),\"MM\") else date_to_string(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),\"MM\") end as 'Date_Month', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' else 'AggregateObject.TotalTransactionAmount' end as 'TotalTransactionAmount',\r\n\r\n case when ('MemberPayout.Status' == \"Approved\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Approved\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Approved\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Approved\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Approved\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else (case when 'MemberPayout.Status' == \"Approved\" then 'FinalRebateAmount' else 0 end)   end as 'Approved TD_Current',\r\n\r\n case when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") &&('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") && ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else (case when 'MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\" then 'FinalRebateAmount' else 0 end)  end as 'Under Review_Current',\r\n \r\n \r\n case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 'FinalRebateAmount' end as 'RebateAmount',\r\n \r\n \r\n case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' else 'RebateAmount' end as 'RebateBeforeAdjustment', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' else 'AggregateObject.TotalQuantity' end as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount';\r\nEnd_Current = foreach current_valid_payout_sources generate 'MemberPayout.Status' as 'MemberPayout.Status',(case when 'MemberPayout.Status' == \"Approved\" then 'DailyFinalRebateAmount' else 0 end) as 'DailyFinalRebateAmount_Approved', (case when 'MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\"  then 'DailyFinalRebateAmount' else 0 end ) as 'DailyFinalRebateAmount_UnderReview' ,{{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 as 'Start', {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000 as 'End', 'Id' as 'Id', 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' as 'Start Date', 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' as 'End Date', case when ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'),\"yyyy\") else  date_to_string(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000),\"yyyy\") end as 'Date_Year', case when ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' < {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'),\"MM\") else  date_to_string(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000),\"MM\") end as 'Date_Month', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyTotalTransactionAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' else 0 end as 'TotalTransactionAmount', \r\n\r\n\r\n\r\ncase when ('MemberPayout.Status' == \"Approved\") && (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Approved\") && (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 0 end as 'Approved TD_Current',\r\n\r\ncase when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") && (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.Status' == \"Interim\" || 'MemberPayout.Status' == \"Pending\" || 'MemberPayout.Status' == \"SystemCalculated\") && (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 0 end as 'Under Review_Current',\r\n\r\ncase when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 0 end as 'RebateAmount',\r\ncase when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyRebateAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' else 0 end as 'RebateBeforeAdjustment', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyQuantity' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Current_PayoutPeriod_FIlter.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' else 0 end as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount';\r\nDataForFill_Current = union Start_Current, End_Current;\r\nDataForFill_Current = foreach DataForFill_Current generate 'Id' as 'Id', 'Date_Year' as 'Date_Year', 'Date_Month' as 'Date_Month','Start' as 'Start', 'End' as 'End', 'Start Date' as 'Start Date', 'End Date' as 'End Date','Approved TD_Current' as 'Approved TD_Current','Under Review_Current' as 'Under Review_Current', 'TotalTransactionAmount' as 'TotalTransactionAmount','RebateAmount' as 'RebateAmount', 'TotalQuantity' as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount','DailyFinalRebateAmount_Approved' as 'DailyFinalRebateAmount_Approved' ,'DailyFinalRebateAmount_UnderReview' as 'DailyFinalRebateAmount_UnderReview','DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount', 'RebateBeforeAdjustment' as 'RebateBeforeAdjustment';\r\nFilledData_Current = fill DataForFill_Current by (dateCols=('Date_Year', 'Date_Month', \"Y-M\"), partition='Id');\r\nFilledData_Current = group FilledData_Current by ('Id', 'Date_Year', 'Date_Month');\r\nFilledData_Current = foreach FilledData_Current generate 'Id', 'Date_Year', 'Date_Month', date_to_epoch(toDate('Date_Year'+\"-\"+'Date_Month'+\"-01\",\"yyyy-MM-dd\")) as 'Date', first('Start') as 'Start', min(first('Start')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'StartFilter', first('End') as 'End', min(first('End')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'EndFilter',  min(first('Start Date')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'Start Date', max(first('End Date')) over ([..] partition by 'Id' ) as 'End Date', sum('Approved TD_Current') as 'Approved TD_Current' ,sum('Under Review_Current') as 'Under Review_Current', sum('TotalTransactionAmount') as 'TotalTransactionAmount', min(first('DailyTotalTransactionAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyTotalTransactionAmount', sum('RebateAmount') as 'RebateAmount', min(first('DailyFinalRebateAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyFinalRebateAmount',min(first('DailyFinalRebateAmount_Approved'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyFinalRebateAmount_Approved',min(first('DailyFinalRebateAmount_UnderReview'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyFinalRebateAmount_UnderReview', sum('RebateBeforeAdjustment') as 'RebateBeforeAdjustment', min(first('DailyRebateAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyRebateAmount', sum('TotalQuantity') as 'TotalQuantity', min(first('DailyQuantity'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyQuantity';\r\nFilledData_Current = filter FilledData_Current by coalesce('Start',0) != 0 || ('Date' > 'StartFilter' && 'Date' > 'Start Date' && 'Date' < 'End Date' && 'Date' < 'EndFilter');\r\nFilledData_Current = foreach FilledData_Current generate 'Id', 'Date_Year', 'Date_Month',\r\n(case when 'TotalTransactionAmount' is null then month_days(toDate('Date'))*'DailyTotalTransactionAmount' else 'TotalTransactionAmount' end) as 'TotalTransactionAmount',\r\n(case when 'RebateAmount' is null then month_days(toDate('Date'))*'DailyFinalRebateAmount' else 'RebateAmount' end) as 'RebateAmount',\r\n(case when 'RebateBeforeAdjustment' is null then month_days(toDate('Date'))*'DailyRebateAmount' else 'RebateBeforeAdjustment' end) as 'RebateBeforeAdjustment',\r\n(case when 'TotalQuantity' is null then month_days(toDate('Date'))*'DailyQuantity' else 'TotalQuantity' end) as 'TotalQuantity',\r\n(case when 'Approved TD_Current' is null then month_days(toDate('Date'))*'DailyFinalRebateAmount_Approved' else 'Approved TD_Current' end) as 'Approved TD_Current',\r\n(case when 'Under Review_Current' is null then month_days(toDate('Date'))*'DailyFinalRebateAmount_UnderReview' else 'Under Review_Current' end) as 'Under Review_Current';\r\nFilledData_Current = group FilledData_Current by all;\nFilledData_Current = foreach FilledData_Current generate  sum('RebateAmount') as 'sum_RebateAmount',sum('Approved TD_Current') as 'sum_Approved TD_Current',sum('Under Review_Current') as 'sum_Under Review_Current';","receiveFacetSource":{"mode":"include","steps":["Bubble_Chart","Current_Qualifier_Value","Tiers","Rebate_Program"]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Current_Qualifier_Value":{"broadcastFacet":true,"groups":[],"label":"Current_Qualifier_Value","numbers":[],"query":"q = load \"ProgramRebateTypeBenefitMaster\";\nq = filter q by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nq = foreach q generate {{coalesce(cell(Current_Tier.result, 0, \"BenefitQualifierValue\"),0).asObject()}} as 'Current_Qualifier';","receiveFacetSource":{"mode":"include","steps":["Rebate_Program","Tiers","Bubble_Chart"]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","max":100,"tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"flatgauge","medium":33,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"colors":{"mediumColor2":"#F29946","mediumColor1":"#FED444","lowColor1":"#F71979","lowColor2":"#CC203D","highColor1":"#7BDE4E","highColor2":"#169913"},"high":66,"min":0,"showActionMenu":true,"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"applyConditionalFormatting":true},"type":"chart"}},"Account_Name_2":{"broadcastFacet":true,"groups":[],"label":"Account_Name_2","numbers":[],"query":"q = load \"MFG_SalesAgreement\";\nq = group q by 'Account.Name';\nq = foreach q generate 'Account.Name' as 'Account.Name', count() as 'count';\nq = order q by 'Account.Name' asc;","receiveFacetSource":{"mode":"all","steps":[]},"selectMode":"singlerequired","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"lens_1":{"broadcastFacet":true,"groups":[],"label":"Tiers_1","numbers":[],"query":"all_benefit_types = load \"ProgramRebateTypeBenefitMaster\";\r\nall_benefit_types = filter all_benefit_types by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster4 = load \"ProgramRebateTypeMaster\";\r\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster4 = filter ProgramRebateTypeMaster4 by 'RebateProgram.Name' in  [\"{{coalesce(cell(Rebate_Program_1.selection, 0, \"RebateProgram.Name\"),cell(Rebate_Program_1.result, 0, \"RebateProgram.Name\"),\"-\").asObject()}}\"];\r\nProgramRebateTypeMaster4 = group ProgramRebateTypeMaster4  by ('Id', 'InclusionFilters.ValuesMultiValue','RebateProgram.Name');\r\nall_benefit_types = filter all_benefit_types by 'RebateType.RebateProgram.Name' in [\"{{coalesce(cell(Rebate_Program_1.selection, 0, \"RebateProgram.Name\"),cell(Rebate_Program_1.result, 0, \"RebateProgram.Name\"),\"-\").asObject()}}\"];\r\nall_benefit_types = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name','Id' as 'Id', 'Name' as 'Name', number_to_string('MinimumQualifyingValue',\"#.0#\") as 'MinimumQualifyingValue_str', 'MinimumQualifyingValue', number_to_string('MaximumQualifyingValue',\"#.0#\") as 'MaximumQualifyingValue_str', 'MaximumQualifyingValue', 'BenefitValue', 'RebateType.RebateMeasureType';\r\nall_benefit_types = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name','Id' as 'Id', 'Name' as 'Name', 'MaximumQualifyingValue', case when len('MaximumQualifyingValue_str') > 5 then (number_to_string('MaximumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MaximumQualifyingValue_str' end as 'MaximumQualifyingValue_str', 'MinimumQualifyingValue', case when len('MinimumQualifyingValue_str') > 5 then (number_to_string('MinimumQualifyingValue'/1000,\"#.0#\")+\"K\") else 'MinimumQualifyingValue_str' end as 'MinimumQualifyingValue_str', 'BenefitValue', 'RebateType.RebateMeasureType', case when 'RebateType.RebateMeasureType'==\"PercentageOfRevenue\" then \"%\" when 'RebateType.RebateMeasureType'==\"Custom\" then \"no units\" else \"$\" end as 'BenefitUnit';\r\nall_benefit_types = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name', 'Id' as 'Id', 'Name' as 'Name', 'MinimumQualifyingValue_str'+\" - \"+'MaximumQualifyingValue_str' as 'Tiers', 'BenefitValue', 'BenefitUnit','MinimumQualifyingValue';\r\nresult = foreach all_benefit_types generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId','RebateType.RebateProgram.Name' as 'RebateType.RebateProgram.Name', 'Id' as 'ProgramRebateTypeBenefitId', first(all_benefit_types.'Tiers') as 'Tiers', first(all_benefit_types.'BenefitUnit') as 'BenefitUnit', case when first(all_benefit_types.'BenefitUnit') == \"%\" then \"%\" else null end as 'BenefitUnit_suffix', case when first(all_benefit_types.'BenefitUnit') == \"$\" then \"$\" else null end as 'BenefitUnit_prefix',\r\ncoalesce(sum(all_benefit_types.'BenefitValue'),0) as 'Benefit Value','MinimumQualifyingValue';\r\nresult = group result by ('ProgramRebateTypeId','ProductId' ,'RebateType.RebateProgram.Name','ProgramRebateTypeBenefitId','Tiers');\r\n--result = foreach result generate 'ProgramRebateTypeId' as 'ProgramRebateTypeId','ProductId' as 'ProductId', 'Tiers' as 'Tiers',sum('Benefit Value') as 'Benefit Multiplier';\r\nresult1 = cogroup result by 'ProgramRebateTypeId' left , ProgramRebateTypeMaster4 by 'Id';\r\nresult1 = foreach result1 generate ProgramRebateTypeMaster4.'InclusionFilters.ValuesMultiValue' as 'InclusionFilters.ValuesMultiValue',  result.'ProductId' as 'ProductId', ProgramRebateTypeMaster4.'RebateProgram.Name' as 'RebateProgram.Name', result.'RebateType.RebateProgram.Name' as 'RebateType.RebateProgram.Name' ,result.'ProgramRebateTypeBenefitId' as 'ProgramRebateTypeBenefitId' , result.'Tiers' as 'Tiers', sum(result.'Benefit Value') as 'Benefit Multiplier';\r\nresult1 = filter result1 by ( 'ProductId' is null || 'ProductId' == \"{{coalesce(cell(Bubble_Chart_1.selection, 0, \"SalesAgreementProduct.ProductId\"),cell(Bubble_Chart_1.result,0,\"SalesAgreementProduct.ProductId\"),\"-\").asString()}}\");\r\nresult1 = foreach result1 generate 'Tiers' as 'Tiers',sum('Benefit Multiplier') as 'Benefit Multiplier';","receiveFacetSource":{"mode":"include","steps":["Rebate_Program_1","Bubble_Chart_1"]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}},"Current_PayoutPeriod_FIlter":{"broadcastFacet":true,"groups":[],"label":"Current_PayoutPeriod_FIlter","numbers":[],"query":"q = load \"RebatePayoutPeriodMaster\";\nq = filter q by 'RebateProgram.Name' == \"{{cell(Rebate_Program.selection, 0, \"RebateProgram.Name\").asString()}}\";\nq = group q by ('RebateProgram.Name','StartDate_Year', 'StartDate_Month', 'StartDate_Day', 'EndDate_Year', 'EndDate_Month', 'EndDate_Day');\nq = foreach q generate 'RebateProgram.Name','StartDate_Year' + \"~~~\" + 'StartDate_Month' + \"~~~\" + 'StartDate_Day' as 'StartDate_Year~~~StartDate_Month~~~StartDate_Day', 'EndDate_Year' + \"~~~\" + 'EndDate_Month' + \"~~~\" + 'EndDate_Day' as 'EndDate_Year~~~EndDate_Month~~~EndDate_Day',case when date_to_epoch(now()) >= first('StartDate_sec_epoch') && date_to_epoch(now()) <= first('EndDate_sec_epoch') then \"True\" else \"False\" end as 'CurrentPayoutPeriod', min('StartDate_sec_epoch')*1000 as 'Min', (max('EndDate_sec_epoch')+86399)*1000  as 'Max';\nq = filter q by 'CurrentPayoutPeriod' == \"True\";","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"single","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"borderColor":"#e0e5ee","borderWidth":1,"cell":{"backgroundColor":"#ffffff","fontColor":"#16325c","fontSize":12},"columnProperties":{},"columns":[],"customBulkActions":[],"header":{"backgroundColor":"#f4f6f9","fontColor":"#16325c","fontSize":12},"innerMajorBorderColor":"#a8b7c7","innerMinorBorderColor":"#e0e5ee","interactions":[],"maxColumnWidth":300,"minColumnWidth":40,"mode":"variable","numberOfLines":1,"showActionMenu":true,"totals":true,"verticalPadding":8},"type":"table"}},"Rebate_Program_1":{"broadcastFacet":true,"groups":[],"label":"Rebate_Program_1","numbers":[],"query":"ProgramRebateTypeMaster = load \"ProgramRebateTypeMaster\";\r\nProgramRebateTypeMaster = filter ProgramRebateTypeMaster by 'CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nProgramRebateTypeMaster = group ProgramRebateTypeMaster by ('InclusionFilters.ValuesMultiValue','RebateProgram.Name');\r\nProductMaster = load \"ProductMaster\";all_payout_sources = load \"ProgramRebateTypePayoutSourceMaster\";all_payout_sources = filter all_payout_sources by 'RebateType.CalculationBasis' in [\"PayoutAndAccrual\", \"Payout\"];\nall_payout_sources = filter all_payout_sources by 'MemberPayout.Member.Account.Name' == \"{{cell(Account_Name_2.result, 0, \"Account.Name\").asString()}}\";\r\ncurrent_valid_payout_sources = filter all_payout_sources by 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000;\r\ncurrent_valid_payout_sources = filter current_valid_payout_sources by 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000;\r\nStart_Current = foreach current_valid_payout_sources generate 'Product.Id' as 'Product.Id', {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 as 'Start', {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 as 'End', 'Id' as 'Id', 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' as 'Start Date', 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' as 'End Date', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),\"yyyy\") else date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),\"yyyy\") end as 'Date_Year', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),\"MM\") else date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),\"MM\") end as 'Date_Month', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyTotalTransactionAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' else 'AggregateObject.TotalTransactionAmount' end as 'TotalTransactionAmount', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 'FinalRebateAmount' end as 'RebateAmount', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyRebateAmount' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' else 'RebateAmount' end as 'RebateBeforeAdjustment', case when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch')))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'))) then (daysBetween(toDate('MemberPayout.PayoutPeriods.StartDate_sec_epoch'),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000))) then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 >= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyQuantity' when ('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000) && ({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000)))) && {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 <= 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' then (daysBetween(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' else 'AggregateObject.TotalQuantity' end as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount';\r\nEnd_Current = foreach current_valid_payout_sources generate  'Product.Id' as 'Product.Id',{{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 as 'Start', {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000 as 'End', 'Id' as 'Id', 'MemberPayout.PayoutPeriods.StartDate_sec_epoch' as 'Start Date', 'MemberPayout.PayoutPeriods.EndDate_sec_epoch' as 'End Date', case when ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'),\"yyyy\") else  date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000),\"yyyy\") end as 'Date_Year', case when ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' < {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000) then date_to_string(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'),\"MM\") else  date_to_string(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000),\"MM\") end as 'Date_Month', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyTotalTransactionAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyTotalTransactionAmount' else 0 end as 'TotalTransactionAmount', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyFinalRebateAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyFinalRebateAmount' else 0 end as 'RebateAmount', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyRebateAmount' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyRebateAmount' else 0 end as 'RebateBeforeAdjustment', case when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' <= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))  then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) - 2764800)))))),toDate('MemberPayout.PayoutPeriods.EndDate_sec_epoch'))) * 'DailyQuantity' when (('MemberPayout.PayoutPeriods.StartDate_sec_epoch' < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ({{coalesce(cell(Date_Filter_1.result,0,\"Min\"),0).asObject()}}/1000 < (date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))) + 86400)) && ('MemberPayout.PayoutPeriods.EndDate_sec_epoch' >= {{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000)) then (daysBetween(toDate((date_to_epoch(month_last_day(toDate((date_to_epoch(month_last_day(toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) - 2764800)))))),toDate({{coalesce(cell(Date_Filter_1.result,0,\"Max\"),0).asObject()}}/1000))) * 'DailyQuantity' else 0 end as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount';\r\nDataForFill_Current = union Start_Current, End_Current;\r\nDataForFill_Current = foreach DataForFill_Current generate  'Product.Id' as 'Product.Id','Id' as 'Id', 'Date_Year' as 'Date_Year', 'Date_Month' as 'Date_Month','Start' as 'Start', 'End' as 'End', 'Start Date' as 'Start Date', 'End Date' as 'End Date', 'TotalTransactionAmount' as 'TotalTransactionAmount', 'RebateAmount' as 'RebateAmount', 'TotalQuantity' as 'TotalQuantity', 'DailyTotalTransactionAmount' as 'DailyTotalTransactionAmount', 'DailyFinalRebateAmount' as 'DailyFinalRebateAmount', 'DailyQuantity' as 'DailyQuantity', 'DailyRebateAmount' as 'DailyRebateAmount', 'RebateBeforeAdjustment' as 'RebateBeforeAdjustment';\r\nFilledData_Current = fill DataForFill_Current by (dateCols=('Date_Year', 'Date_Month', \"Y-M\"), partition='Id');\r\nFilledData_Current = group FilledData_Current by ('Id', 'Date_Year', 'Date_Month','Product.Id');\r\nFilledData_Current = foreach FilledData_Current generate 'Id', 'Date_Year', 'Date_Month','Product.Id', date_to_epoch(toDate('Date_Year'+\"-\"+'Date_Month'+\"-01\",\"yyyy-MM-dd\")) as 'Date', first('Start') as 'Start', min(first('Start')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'StartFilter', first('End') as 'End', min(first('End')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'EndFilter',  min(first('Start Date')) over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'Start Date', max(first('End Date')) over ([..] partition by 'Id' ) as 'End Date',  sum('TotalTransactionAmount') as 'TotalTransactionAmount', min(first('DailyTotalTransactionAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyTotalTransactionAmount', sum('RebateAmount') as 'RebateAmount', min(first('DailyFinalRebateAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyFinalRebateAmount', sum('RebateBeforeAdjustment') as 'RebateBeforeAdjustment', min(first('DailyRebateAmount'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyRebateAmount', sum('TotalQuantity') as 'TotalQuantity', min(first('DailyQuantity'))over ([..0] partition by 'Id' order by ('Date_Year','Date_Month')) as 'DailyQuantity';\r\nFilledData_Current = filter FilledData_Current by coalesce('Start',0) != 0 || ('Date' > 'StartFilter' && 'Date' > 'Start Date' && 'Date' < 'End Date' && 'Date' < 'EndFilter');\r\nFilledData_Current = foreach FilledData_Current generate 'Product.Id' as 'Product.Id','Id', 'Date_Year', 'Date_Month', (case when 'TotalTransactionAmount' is null then month_days(toDate('Date'))*'DailyTotalTransactionAmount' else 'TotalTransactionAmount' end) as 'TotalTransactionAmount', (case when 'RebateAmount' is null then month_days(toDate('Date'))*'DailyFinalRebateAmount' else 'RebateAmount' end) as 'RebateAmount', (case when 'RebateBeforeAdjustment' is null then month_days(toDate('Date'))*'DailyRebateAmount' else 'RebateBeforeAdjustment' end) as 'RebateBeforeAdjustment', (case when 'TotalQuantity' is null then month_days(toDate('Date'))*'DailyQuantity' else 'TotalQuantity' end) as 'TotalQuantity';\r\nFilledData_Current = group FilledData_Current by 'Product.Id';\r\nFilledData_Current = foreach FilledData_Current generate 'Product.Id' as 'Product.Id',\r\nsum('RebateAmount')/ sum('TotalTransactionAmount') as 'Avg Effective Rebate';\r\nResult = cogroup ProgramRebateTypeMaster  by 'InclusionFilters.ValuesMultiValue' left,ProductMaster by 'Id' left,FilledData_Current by 'Product.Id';\r\nResult = foreach Result generate first(ProductMaster.'Name') as 'Name', ProgramRebateTypeMaster.'InclusionFilters.ValuesMultiValue' as 'ProductId',ProgramRebateTypeMaster.'RebateProgram.Name' as 'RebateProgram.Name', sum(FilledData_Current.'Avg Effective Rebate') as 'Avg Effective Rebate';\r\nResult = filter Result by 'Name' is not null;\r\nResult = filter Result by 'Name' == \"{{coalesce(cell(Bubble_Chart_1.selection, 0, \"SalesAgreementProduct.Name\"),cell(Bubble_Chart_1.result,0,\"SalesAgreementProduct.Name\"),\"-\").asString()}}\";\r\nResult = foreach Result generate  'RebateProgram.Name' as 'RebateProgram.Name', coalesce('Avg Effective Rebate',0) as 'Avg Effective Rebate';\r\nResult = order Result by 'Avg Effective Rebate' desc;","receiveFacetSource":{"mode":"none","steps":[]},"selectMode":"singlerequired","start":"[]","strings":[],"type":"saql","useGlobal":true,"visualizationParameters":{"parameters":{"autoFitMode":"keepLabels","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":true,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round"}}},"applyConditionalFormatting":true},"type":"chart"}}},"widgetStyle":{"backgroundColor":"#FFFFFF","borderColor":"#E6ECF2","borderEdges":[],"borderRadius":0,"borderWidth":1},"widgets":{"text_14":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"24px","color":"#FFFFFF","align":"right"},"insert":"{{coalesce(cell(Toggle.result, 0, \"Incentive_count\"), \"0\").asString()}}"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_13":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"24px","color":"#091A3E","align":"right"},"insert":"{{coalesce(cell(Toggle.result, 1, \"Incentive_count\"), \"0\").asString()}}"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_16":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"left"},"insert":"Suggested Programs"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_10":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"24px","color":"#091A3E","align":"right"},"insert":"{{coalesce(cell(Toggle.result, 0, \"Incentive_count\"), \"0\").asString()}}"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_11":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"24px","color":"#FFFFFF","align":"right"},"insert":"{{coalesce(cell(Toggle.result, 1, \"Incentive_count\"), \"0\").asString()}}"}]},"interactions":[],"showActionMenu":true},"type":"text"},"container_1":{"parameters":{"alignmentX":"left","alignmentY":"top","fit":"original","interactions":[]},"type":"container"},"text_3":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"left"},"insert":"Tiers & Benefits"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_2":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"left"},"insert":"Enrolled Programs"}]},"interactions":[],"showActionMenu":true},"type":"text"},"chart_5":{"parameters":{"autoFitMode":"none","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":false,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"Avg Effective Rebate ↓","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","step":"Rebate_Program_1","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":false,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round","parameters":{}}}},"applyConditionalFormatting":true},"type":"chart"},"text_5":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"12px","color":"#091A3E","align":"center"},"insert":"Current Tier"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_4":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"12px","color":"#091A3E","align":"center"},"insert":"Payouts to Date"}]},"interactions":[],"showActionMenu":true},"type":"text"},"chart_2":{"parameters":{"autoFitMode":"none","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":false,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"Avg Effective Rebate ↓","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","step":"Rebate_Program","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":false,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round","parameters":{}}}},"applyConditionalFormatting":true},"type":"chart"},"text_7":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"center"},"insert":"{{coalesce(cell(Current_Tier.result, 0, \"Tiers\"),\"NA\").asString()}}"}]},"interactions":[],"showActionMenu":true},"type":"text"},"chart_1":{"parameters":{"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"top-center","inside":false},"tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"scatter","exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"radiusRatio":3,"columnMap":{"r":[],"x":["Planned_Revenue"],"y":["Compliance"],"trellis":[],"plots":["SalesAgreementProduct.Name"]},"showActionMenu":true,"x":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"y":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"theme":"wave","step":"Bubble_Chart","applyConditionalFormatting":true},"type":"chart"},"text_6":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"12px","color":"#091A3E","align":"center"},"insert":"Purchases Required for Tier Upgrade"}]},"interactions":[],"showActionMenu":true},"type":"text"},"text_9":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"left"},"insert":"Incentives"}]},"interactions":[],"showActionMenu":true},"type":"text"},"chart_4":{"parameters":{"autoFitMode":"none","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":false,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","step":"lens_1","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":false,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round","parameters":{}}}},"applyConditionalFormatting":true},"type":"chart"},"text_8":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"center"},"insert":"{{coalesce(cell(Progress_To_Next.result, 0, \"Progress_To_Next_Tier\"),0).asString()}} Units"}]},"interactions":[],"showActionMenu":true},"type":"text"},"chart_3":{"parameters":{"legend":{"descOrder":false,"showHeader":true,"show":true,"customSize":"auto","position":"top-center","inside":false},"tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"scatter","exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"radiusRatio":3,"columnMap":{"r":[],"x":["Planned_Revenue"],"y":["Compliance"],"trellis":[],"plots":["SalesAgreementProduct.Name"]},"showActionMenu":true,"x":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"y":{"sqrtScale":false,"showZero":true,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"theme":"wave","step":"Bubble_Chart_1","applyConditionalFormatting":true},"type":"chart"},"text_1":{"parameters":{"content":{"richTextContent":[{"attributes":{"size":"16px","color":"#091A3E","align":"left"},"insert":"Products That Need Attention"}]},"interactions":[],"showActionMenu":true},"type":"text"},"link_3":{"parameters":{"destinationLink":{"name":"b6e89414-7327-4fc6-bd17-098a19833fe7"},"destinationType":"page","fontSize":14,"includeState":false,"text":"{{coalesce(cell(Toggle.result, 1, \"Incentive\"), \"-\").asString()}}","textAlignment":"left","textColor":"#FFFFFF"},"type":"link"},"link_4":{"parameters":{"destinationLink":{"name":"7eed5703-a19c-4eae-8c67-ce65fe1ef2c7"},"destinationType":"page","fontSize":14,"includeState":false,"text":"{{coalesce(cell(Toggle.result, 0, \"Incentive\"), \"-\").asString()}}","textAlignment":"left","textColor":"#FFFFFF"},"type":"link"},"link_1":{"parameters":{"destinationLink":{"name":"b6e89414-7327-4fc6-bd17-098a19833fe7"},"destinationType":"page","fontSize":14,"includeState":false,"text":"{{coalesce(cell(Toggle.result, 1, \"Incentive\"), \"-\").asString()}}","textAlignment":"left","textColor":"rgb(0, 112, 210)"},"type":"link"},"link_2":{"parameters":{"destinationLink":{"name":"7eed5703-a19c-4eae-8c67-ce65fe1ef2c7"},"destinationType":"page","fontSize":14,"includeState":false,"text":"{{coalesce(cell(Toggle.result, 0, \"Incentive\"), \"-\").asString()}}","textAlignment":"left","textColor":"rgb(0, 112, 210)"},"type":"link"},"number_1":{"parameters":{"compact":false,"exploreLink":true,"interactions":[],"measureField":"sum_Approved TD_Current","noResultsLabel":"0","numberColor":"#091A3E","numberSize":16,"showActionMenu":true,"step":"Payouts","textAlignment":"center","title":"","titleColor":"#091A3E","titleSize":16,"tooltip":{"customizeTooltip":false}},"type":"number"},"chart_17":{"parameters":{"autoFitMode":"keepLabels","max":"{{cell(Progress_To_Next.result, 0, \"Min\").asObject()}}","legend":{"showHeader":true,"show":false,"position":"right-top","inside":false},"tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"flatgauge","medium":33,"exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"colors":{"mediumColor2":"#F29946","mediumColor1":"#FED444","lowColor1":"#F71979","lowColor2":"#CC203D","highColor1":"#7BDE4E","highColor2":"#169913"},"high":66,"min":0,"showActionMenu":true,"valueType":"compactNumber","theme":"wave","step":"Current_Qualifier_Value","compactDecimalDigits":-1,"applyConditionalFormatting":true},"type":"chart"},"chart_38":{"parameters":{"autoFitMode":"none","bins":{"breakpoints":{"high":100,"low":0},"bands":{"high":{"color":"#008000","label":""},"low":{"color":"#B22222","label":""},"medium":{"color":"#ffa500","label":""}}},"legend":{"descOrder":false,"showHeader":true,"show":false,"customSize":"auto","position":"right-top","inside":false},"axisMode":"multi","tooltip":{"content":{"legend":{"showBinLabel":true,"measures":[],"showNullValues":true,"customizeLegend":false,"showPercentage":true,"showDimensions":true,"showMeasures":true,"dimensions":[]}}},"visualizationType":"hbar","exploreLink":true,"title":{"fontSize":14,"subtitleFontSize":11,"label":"","align":"center","subtitleLabel":""},"binValues":false,"trellis":{"flipLabels":false,"showGridLines":true,"size":[100,100],"enable":false,"type":"x","parameters":{},"chartsPerLine":4},"showActionMenu":true,"measureAxis2":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"measureAxis1":{"sqrtScale":false,"showTitle":true,"showAxis":true,"title":"","customDomain":{"showDomain":false}},"valueType":"compactNumber","theme":"wave","step":"Tiers","compactDecimalDigits":-1,"dimensionAxis":{"showTitle":false,"customSize":"auto","showAxis":true,"title":"","icons":{"useIcons":false,"iconProps":{"fit":"cover","column":"","type":"round","parameters":{}}}},"applyConditionalFormatting":true},"type":"chart"},"image_2":{"parameters":{"alignmentX":"left","alignmentY":"top","fit":"fitwidth","image":{"name":"Artboard2xpng47","namespace":""},"interactions":[]},"type":"image"}}}