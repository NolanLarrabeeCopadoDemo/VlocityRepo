["{\"nodes\":{\"Augment_LoyaltyMemberTier_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"MemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyMemberTier\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyTier.LoyaltyTierGroup.Name\",\"LoyaltyTier.Name\"]},\"sources\":[\"Augment_LoyaltyMemberCurrency_onto_TransactionJournal\",\"Append_LoyaltyMemberTier_with_GroupMember\"]},\"Augment_Referrer_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ReferredById\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Referrer\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Account.Name\",\"Contact.Birthdate\",\"Contact.MobilePhone\",\"Contact.Name\",\"MembershipNumber\"]},\"sources\":[\"Augment_LoyaltyProgram_onto_LoyaltyProgramMember\",\"Augment_LoyaltyProgram_onto_LoyaltyProgramMember\"]},\"Augment_LoyaltymemberCurrency_onto_Voucher\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramMemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyMemberCurrency\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramCurrency.QP_Currency\",\"LoyaltyProgramMember.LoyaltyProgram.Name\",\"LoyaltyProgramMember.MemberName\",\"LoyaltyProgramMember.MemberType\"]},\"sources\":[\"Augment_VoucherDefinition_onto_Voucher\",\"Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\"]},\"Digest_JournalSubType\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Description\"},{\"name\":\"JournalTypeId\"},{\"name\":\"Name\"}],\"object\":\"JournalSubType\"}},\"Register_LoyaltyMemberCurrency\":{\"action\":\"register\",\"parameters\":{\"label\":\"LoyaltyMemberCurrency\",\"name\":\"LoyaltyMemberCurrency\"},\"sources\":[\"Augment_LoyaltyMemberTier_onto_LoyaltyMemberCurrency\"]},\"Augment_TransactionJournal_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"TransactionJournalId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"TransactionJournal\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"ActivityDate\",\"JournalDate\",\"MemberId\",\"Status\",\"UsageType\",\"Industry\",\"Brand\",\"Channel\",\"PartnerId\",\"Quantity\",\"QuantityUnitOfMeasureId\",\"RelatedJournalId\",\"TransactionAmount\",\"TransactionLocation\",\"Establishment\",\"JournalType.Name\",\"JournalSubType.Name\",\"LoyaltyProgramMember.EnrollmentChannel\",\"LoyaltyProgramMember.EnrollmentDate\",\"LoyaltyProgramMember.LastActivityDate\",\"LoyaltyProgramMember.MembershipEndDate\",\"LoyaltyProgramMember.MembershipNumber\",\"LoyaltyProgramMember.MemberStatus\",\"LoyaltyProgramMember.MemberType\",\"LoyaltyProgramMember.ProgramId\",\"LoyaltyProgramMember.Contact.Birthdate\",\"LoyaltyProgramMember.Contact.Name\",\"LoyaltyProgramMember.Contact.MobilePhone\",\"LoyaltyProgramMember.Account.Name\",\"LoyaltyProgramMember.LoyaltyProgram.Name\",\"LoyaltyProgramMember.Referrer.Contact.Birthdate\",\"LoyaltyProgramMember.Referrer.Contact.Name\",\"LoyaltyProgramMember.Referrer.Contact.MobilePhone\",\"LoyaltyProgramMember.AccountContact.Id\",\"LoyaltyProgramMember.MemberTenureBucket\",\"LoyaltyProgramMember.IsReferral\",\"LoyaltyProgramMember.MemberName\",\"LoyaltyProgramMember.LeadOrContactId\",\"LoyaltyProgramMember.LeadOrContactName\",\"LoyaltyProgramMember.MemberCity\",\"LoyaltyProgramMember.MemberState\",\"LoyaltyProgramMember.MemberCountry\",\"LoyaltyProgramPartner.PartnerCategory\",\"LoyaltyProgramPartner.PartnerIndustry\",\"LoyaltyProgramPartner.PartnerType\",\"LoyaltyProgramPartner.Partner.Name\",\"LoyaltyProgramPartner.Partner.Type\",\"Product.Family\",\"Product.Name\",\"Product.ProductCode\",\"ProductCategory.Name\",\"User.SmallPhotoUrl\",\"User.UniqueUserName\",\"Product_or_ProductCategory\",\"Product_or_ProductCategory_ID\",\"JournalReason\"]},\"sources\":[\"Digest_LoyaltyLedger\",\"CE_TransactionJournal\"]},\"Filter_TransactionJournal_GetAccrualDatesByProgramMember\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"('JournalType.Name' == \\\"Accrual\\\" && 'Status' == \\\"Processed\\\" && 'ProgramMemberTemp.MemberType' != \\\"Group\\\") ||  ('JournalType.Name' == \\\"Redemption\\\" && 'Status' == \\\"Processed\\\" && 'ProgramMemberTemp.MemberType' == \\\"Group\\\") \"},\"sources\":[\"Augment_LoyaltyProgramMember_onto_TransactionJournal_Temp\"]},\"CE_LoyaltyMemberCurrency\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"PointsBalance_Amount\",\"name\":\"PointsBalance_Amount\",\"precision\":10,\"saqlExpression\":\"PointsBalance*'LoyaltyProgramCurrency.CostperUnit'\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\"]},\"CR_Dummy\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"next()\",\"sourceField\":\"QuestionId\",\"default\":\"Dummy\"},\"label\":\"CR_Computed_Dummy\",\"name\":\"CR_Computed_Dummy\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"QuestionId\"}],\"partitionBy\":[\"QuestionId\"]},\"sources\":[\"CE_Dummy\"]},\"Register_Voucher\":{\"action\":\"register\",\"parameters\":{\"label\":\"Voucher\",\"name\":\"Voucher\"},\"sources\":[\"Augment_LoyaltyMemberTier_onto_Voucher\"]},\"Augment_LoyaltyProgramMember_onto_TransactionJournal_Temp\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"MemberId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ProgramMemberTemp\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"MemberType\"]},\"sources\":[\"Augment_JournalType_onto_TransactionJournal\",\"Digest_LoyaltyProgramMember\"]},\"Augment_AccrualReversal_onto_Related1_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RelatedTransactionJournal1.TransactionJournal.RelatedJournalId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RelatedTransactionJournal2\",\"rightKey\":[\"TransactionJournal.RelatedJournalId\"],\"rightSelect\":[\"TransactionJournalId\"]},\"sources\":[\"Augment_RelatedLoyaltyLedger_onto_GroupMember_LoyaltyLedger\",\"Filter_LoyaltyLedger_AccrualReversals_for_NonGroup_Members\"]},\"Slice_GroupTierName\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"Name\"}],\"mode\":\"drop\"},\"sources\":[\"Augment_LoyaltyTierGroup_onto_LoyaltyTier\"]},\"Dim2Mea_SurveyQuestionChoice_Convert_MaxValueStr_to_Number\":{\"action\":\"dim2mea\",\"parameters\":{\"dimension\":\"Name\",\"measure\":\"NumberValue\",\"measureDefault\":\"0\",\"measureType\":\"long\"},\"sources\":[\"Append_SurveyQuestionChoice_w_RatingQuestion_with_Dummy\"]},\"Augment_ProductCategory_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProductCategoryId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ProductCategory\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Augment_Product_onto_TransactionJournal\",\"Digest_ProductCategory\"]},\"Register_LoyaltyProgramCurrency\":{\"action\":\"register\",\"parameters\":{\"label\":\"LoyaltyProgramCurrency\",\"name\":\"LoyaltyProgramCurrency\"},\"sources\":[\"Augment_LoyaltyProgram_onto_LoyaltyProgramCurrency\"]},\"Digest_LoyaltyProgramMember\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ContactId\"},{\"defaultValue\":\"NA\",\"name\":\"EnrollmentChannel\"},{\"name\":\"EnrollmentDate\"},{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"LastActivityDate\"},{\"name\":\"MembershipEndDate\"},{\"name\":\"MembershipLastRenewalDate\"},{\"name\":\"MembershipNumber\"},{\"name\":\"MemberStatus\"},{\"name\":\"MemberType\"},{\"name\":\"ProgramId\"},{\"name\":\"ReferredById\"},{\"name\":\"AccountId\"}],\"object\":\"LoyaltyProgramMember\"}},\"Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramCurrencyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramCurrency\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CurrencyType\",\"Id\",\"IsPrimary\",\"NQP_Currency\",\"QP_Currency\",\"CostperUnit\"]},\"sources\":[\"Augment_LoyaltyProgramMember_onto_LoyaltyMemberCurrency\",\"CE_LoyaltyProgramCurrency\"]},\"Digest_Survey\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActiveVersionId\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"Description\"},{\"name\":\"DeveloperName\"},{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"SurveyType\"},{\"name\":\"TotalVersionsCount\"},{\"name\":\"LatestVersionId\"}],\"object\":\"Survey\"}},\"Augment_LoyaltyMemberTier_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramMemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyTierMember\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyTier.Name\",\"LoyaltyTier.LoyaltyTierGroup.Name\"]},\"sources\":[\"Augment_LoyaltyProgramCurrency_onto_LoyaltyLedger\",\"Append_LoyaltyMemberTier_with_GroupMember\"]},\"Augment_Survey_onto_SurveyVersion\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Survey\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Digest_SurveyVersion\",\"Digest_Survey\"]},\"Slice_OldPoints_LoyaltyLedger\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"Points\"},{\"name\":\"GroupPoints.Points\"}],\"mode\":\"drop\"},\"sources\":[\"Compute_PointField_LoyaltyLedger\"]},\"Slice_GroupMember\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"LoyaltyTier.Name\"},{\"name\":\"LoyaltyTier.LoyaltyTierGroup.Name\"},{\"name\":\"LoyaltyMemberId\"},{\"name\":\"Id\"}],\"mode\":\"select\"},\"sources\":[\"CE_GroupMember_w_Tier\"]},\"Digest_ProductCategory\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Description\"},{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"ProductCategory\"}},\"Augment_Account_onto_Contact\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Account\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\"]},\"sources\":[\"Digest_Contact\",\"Digest_Account\"]},\"Filter_SurveySubject_with_LoyaltyProgram\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SubjectEntityType' == \\\"LoyaltyProgram\\\" && 'SurveyInvitation.ParticipantId' is null\"},\"sources\":[\"CE_SurveySubject\"]},\"Filter_SurveyQuestionResponse_with_TransactionJournalRecords\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveySubject.SubjectEntityType' == \\\"TransactionJournal\\\"\"},\"sources\":[\"CE_SurveyQuestionResponse_Final\"]},\"CE_TransactionJournal\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Product or Product Category\",\"name\":\"Product_or_ProductCategory\",\"saqlExpression\":\"coalesce('Product.Name', 'ProductCategory.Name')\",\"type\":\"Text\"},{\"label\":\"Product_or_ProductCategory_Flag\",\"name\":\"Product_or_ProductCategory_Flag\",\"saqlExpression\":\"case when 'ProductId' is not null then \\\"Product\\\" when 'ProductCategoryId' is not null then \\\"ProductCategory\\\" end\",\"type\":\"Text\"},{\"label\":\"Product_or_ProductCategory_ID\",\"name\":\"Product_or_ProductCategory_ID\",\"saqlExpression\":\"coalesce('ProductId', 'ProductCategoryId')\",\"type\":\"Text\"},{\"label\":\"JournalType_Name\",\"name\":\"JournalType_Name\",\"saqlExpression\":\"case when Status == \\\"Processed\\\" then\\ncase when 'LoyaltyProgramMember.MemberType' != \\\"Group\\\" then 'JournalType.Name' when 'LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'JournalType.Name' in [\\\"Redemption\\\", \\\"Redemption Reversal\\\"] then 'JournalType.Name' when 'LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'JournalType.Name' not in [\\\"Redemption\\\", \\\"Redemption Reversal\\\"] then 'JournalType.Name'+\\\"_Group\\\" end else 'JournalType.Name'+\\\"_\\\"+'Status' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_User_onto_TransactionJournal\"]},\"Augment_ProgramTier_onto_GroupMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyTier\",\"rightKey\":[\"LoyaltyTierGroup.LoyaltyProgramId\"],\"rightSelect\":[\"Id\",\"LoyaltyTierGroup.Name\",\"Name\",\"LoyaltyTierGroupId\",\"SequenceNumber\"]},\"sources\":[\"Filter_LoyaltyProgramMember_Group\",\"CE_GroupTier_Name\"]},\"Digest_SurveyQuestionResponse\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ChoiceValue\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"Datatype\"},{\"name\":\"DateTimeValue\"},{\"name\":\"DateValue\"},{\"name\":\"Id\"},{\"name\":\"InvitationId\"},{\"name\":\"IsDeleted\"},{\"name\":\"IsTrueOrFalse\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"NumberValue\"},{\"name\":\"QuestionChoiceId\"},{\"name\":\"QuestionId\"},{\"name\":\"Rank\"},{\"name\":\"ResponseId\"},{\"name\":\"ResponseShortText\"},{\"name\":\"ResponseValue\"},{\"name\":\"SurveyVersionId\"},{\"name\":\"SystemModstamp\"}],\"object\":\"SurveyQuestionResponse\"}},\"Filter_SurveySubject_with_Program_and_Participant\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SubjectEntityType' == \\\"LoyaltyProgram\\\" && 'SurveyInvitation.ParticipantId' is not null\"},\"sources\":[\"CE_SurveySubject\"]},\"Digest_SurveyVersion\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"SurveyId\"},{\"name\":\"VersionNumber\"}],\"object\":\"SurveyVersion\"}},\"Register_LoyaltyLedger_ManualActions\":{\"action\":\"register\",\"parameters\":{\"label\":\"LoyaltyLedger_ManualActions\",\"name\":\"LoyaltyLedger_ManualActions\",\"rowLevelSecurityFilter\":\"'CreatedById' == \\\"$User.Id\\\" || 'User.Parents' == \\\"$User.UserRoleId\\\"\"},\"sources\":[\"Filter_LoyaltyLedger1\"]},\"Filter_SurveyQuestionResponse1\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'CR_Computed_Dummy' != \\\"Dummy\\\" && 'SurveySubject.SubjectEntityType' in [\\\"LoyaltyProgram\\\", \\\"TransactionJournal\\\"]\"},\"sources\":[\"Augment_SurveySubject_onto_SurveyQuestionResponse\"]},\"Digest_VoucherDefinition\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"EffectiveDate\"},{\"name\":\"CostPerVoucher\"},{\"name\":\"FaceValue\"},{\"name\":\"Type\"},{\"name\":\"Name\"},{\"name\":\"DiscountPercent\"},{\"name\":\"ExpirationDate\"}],\"object\":\"VoucherDefinition\"}},\"Augment_LoyaltyMemberCurrency_onto_LoyaltyMemberTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyMemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyMemberCurrency\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyProgramMember.Contact.Birthdate\",\"LoyaltyProgramMember.Contact.Name\",\"LoyaltyProgramMember.Contact.MobilePhone\",\"LoyaltyProgramMember.Referrer.Contact.Birthdate\",\"LoyaltyProgramMember.Referrer.Contact.Name\",\"LoyaltyProgramMember.Referrer.Contact.MobilePhone\",\"LoyaltyProgramMember.AccountContact.Id\",\"LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramCurrency.QP_Currency\",\"LoyaltyProgramCurrency.IsPrimary\"]},\"sources\":[\"Augment_LoyaltyProgramMember_onto_LoyaltyMemberTier\",\"Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\"]},\"Augment_CSAT_SurveyQuestion_MaxValue_onto_SurveyQuestionresponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"QuestionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"QuestionChoice\",\"rightKey\":[\"QuestionId\"],\"rightSelect\":[\"MaxValueString\",\"MaxValue\"]},\"sources\":[\"Filter_SurveyQuestionResponse1\",\"CR_SurveyQuestionChoice1\"]},\"Augment_FinalRelatedTransactionJournal_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"TransactionJournalId\",\"LoyaltyProgramCurrencyId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"GroupPoints\",\"rightKey\":[\"RelatedTransactionJournal\",\"LoyaltyProgramCurrencyId\"],\"rightSelect\":[\"Points\"]},\"sources\":[\"Augment_TransactionJournal_onto_LoyaltyLedger\",\"Compute_FinalRelatedTransactionJournal_LoyaltyLedger\"]},\"Update_SurveySubject_with_Participant_Details\":{\"action\":\"update\",\"parameters\":{\"leftKey\":[\"SubjectId_CompositeKey\"],\"rightKey\":[\"SubjectId_CompositeKey\"],\"updateColumns\":{\"LoyaltyProgramTier.Name\":\"Participant.LoyaltyTier.Name\",\"LoyaltyProgramTier.LoyaltyProgram.Name\":\"Participant.LoyaltyProgramMember.LoyaltyProgram.Name\",\"LoyaltyProgramTier.LoyaltyProgramCurrency.NQP_Currency\":\"Participant.LoyaltyMemberCurrency.LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramTier.LoyaltyTierGroup.Name\":\"Participant.LoyaltyTier.LoyaltyTierGroup.Name\",\"LoyaltyProgramTier.LoyaltyProgramCurrency.QP_Currency\":\"Participant.LoyaltyMemberCurrency.LoyaltyProgramCurrency.QP_Currency\"}},\"sources\":[\"Append_SurveySubject_All\",\"Augment_Participant_onto_SurveySubject\"]},\"Digest_Account\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"Type\"},{\"name\":\"BillingCity\"},{\"name\":\"BillingCountry\"},{\"name\":\"BillingState\"}],\"object\":\"Account\"}},\"Append_SurveyQuestionChoice_w_RatingQuestion_with_Dummy\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Filter_SurveyQuestionChoice_with_RatingQuestion\",\"Filter_Dummy\"]},\"CR_Unique_User_Flag\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"next()\",\"sourceField\":\"Id\"},\"label\":\"isDuplicate\",\"name\":\"isDuplicate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Id\"}],\"partitionBy\":[\"Name\"]},\"sources\":[\"Flatten_UserRole\"]},\"CE_SurveyQuestionResponse\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Question_Response_Id\",\"name\":\"Question_Response_Id\",\"saqlExpression\":\"'QuestionId' + \\\"-\\\" + 'ResponseId'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Filter_SurveyQuestionResponse\"]},\"CR_SurveyQuestionChoice1\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"Name\"},\"label\":\"MaxValueString\",\"name\":\"MaxValueString\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"NumberValue\"},\"label\":\"MaxValue\",\"name\":\"MaxValue\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"NumberValue\"}],\"partitionBy\":[\"QuestionId\"]},\"sources\":[\"Dim2Mea_SurveyQuestionChoice_Convert_MaxValueStr_to_Number\"]},\"Filter_SurveySubject_with_TransactionJournal\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SubjectEntityType' == \\\"TransactionJournal\\\"\"},\"sources\":[\"CE_SurveySubject\"]},\"Augment_TransactionType_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveySubject.SubjectId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyLedger\",\"rightKey\":[\"TransactionJournalId\"],\"rightSelect\":[\"ChangeReasonType\",\"TransactionType\"]},\"sources\":[\"Augment_SurveyVersion_onto_SurveyQuestionResponse\",\"CE_LoyaltyLedger\"]},\"Augment_LoyaltyProgram_onto_LoyaltyProgramCurrency\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgram\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"CE_LoyaltyProgramCurrency\",\"Digest_LoyaltyProgram\"]},\"Digest_LoyaltyProgramCurrency\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CurrencyType\"},{\"name\":\"ExpiryModel\"},{\"name\":\"ExpiryPeriodFrequency\"},{\"name\":\"ExpiryPeriodUnit\"},{\"name\":\"Id\"},{\"name\":\"IsActive\"},{\"name\":\"LoyaltyProgramId\"},{\"name\":\"LoyaltyTierGroupId\"},{\"name\":\"Name\"},{\"name\":\"IsPrimary\"},{\"name\":\"CostperUnit\"}],\"object\":\"LoyaltyProgramCurrency\"}},\"Digest_LoyaltyProgram\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Description\"},{\"name\":\"Name\"},{\"name\":\"Status\"}],\"object\":\"LoyaltyProgram\"}},\"Augment_JournalSubType_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"JournalSubTypeId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"JournalSubType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Augment_JournalType_onto_TransactionJournal\",\"Digest_JournalSubType\"]},\"Append_LoyaltyMemberTier_with_GroupMember\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Augment_LoyaltyTier_onto_LoyaltyMemberTier\",\"Slice_GroupMember\"]},\"Digest_LoyaltyProgramPartner\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"LoyaltyPartnerId\"},{\"name\":\"LoyaltyProgramId\"},{\"name\":\"Name\"},{\"name\":\"PartnerCategory\"},{\"name\":\"PartnerIndustry\"},{\"name\":\"PartnershipEndDate\"},{\"name\":\"PartnershipStartDate\"},{\"name\":\"PartnerStatus\"},{\"name\":\"PartnerType\"}],\"object\":\"LoyaltyProgramPartner\"}},\"Augment_LoyaltyProgramMember_onto_LoyaltyMemberTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyMemberId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramMember\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"ContactId\",\"EnrollmentChannel\",\"EnrollmentDate\",\"MembershipEndDate\",\"MembershipLastRenewalDate\",\"MembershipNumber\",\"MemberStatus\",\"MemberType\",\"ProgramId\",\"ReferredById\",\"Contact.Birthdate\",\"Contact.Name\",\"Contact.MobilePhone\",\"Account.Name\",\"LoyaltyProgram.Name\",\"Referrer.Contact.Name\",\"Referrer.Account.Name\",\"TransactionJournal.FirstAccrualDate\",\"TransactionJournal.SecondAccrualDate\",\"AccountContact.Id\",\"MemberTenureBucket\",\"IsReferral\",\"MemberName\",\"MemberId\",\"LeadOrContactId\",\"LeadOrContactName\",\"MemberState\",\"MemberCity\",\"MemberCountry\"]},\"sources\":[\"Append_LoyaltyMemberTier_with_GroupMember\",\"CE_LoyaltyProgramMember\"]},\"CE_GroupMember_w_Tier\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"LoyaltyMemberId\",\"name\":\"LoyaltyMemberId\",\"saqlExpression\":\"'Id'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_ProgramTier_onto_GroupMember\"]},\"Augment_LoyaltyProgramMember_onto_LoyaltyMemberCurrency\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyMemberId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramMember\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"EnrollmentChannel\",\"EnrollmentDate\",\"LastActivityDate\",\"MembershipEndDate\",\"MembershipNumber\",\"MemberStatus\",\"MemberType\",\"ProgramId\",\"Contact.Birthdate\",\"Contact.Name\",\"Contact.MobilePhone\",\"Account.Name\",\"LoyaltyProgram.Name\",\"Referrer.Contact.Birthdate\",\"Referrer.Contact.Name\",\"Referrer.Contact.MobilePhone\",\"Referrer.Account.Name\",\"AccountContact.Id\",\"IsReferral\",\"MemberName\",\"LeadOrContactId\",\"LeadOrContactName\"]},\"sources\":[\"Digest_LoyaltyMemberCurrency\",\"CE_LoyaltyProgramMember\"]},\"Augment_Survey_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Survey\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Description\",\"Name\",\"SurveyType\"]},\"sources\":[\"Append_SurveySubject\",\"Digest_Survey\"]},\"Filter_SurveyQuestionResponse\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyQuestion.QuestionType' in [\\\"NPS\\\", \\\"Rating\\\"]\"},\"sources\":[\"Augment_SurveyResponse_onto_SurveyQuestionResponse\"]},\"Augment_Product_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProductId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Product\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Family\",\"Name\",\"ProductCode\"]},\"sources\":[\"Augment_LoyaltyProgramPartner_onto_TransactionJournal\",\"Digest_Product\"]},\"Augment_SurveyInvitation_woParticipant_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ParentId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"SurveyInvitation\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\"]},\"sources\":[\"Digest_SurveySubject\",\"Filter_SurveyInvitation_without_Participant\"]},\"CE_Dummy\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"QuestionId\",\"name\":\"QuestionId\",\"saqlExpression\":\"\\\"All\\\"\",\"type\":\"Text\"},{\"label\":\"Question_Response_Id\",\"name\":\"Question_Response_Id\",\"saqlExpression\":\"\\\"All\\\"\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"isYearEndFiscalYear\":true,\"label\":\"CompletionDateTime\",\"name\":\"CompletionDateTime\",\"saqlExpression\":\"toDate(\\\"1970-01-01\\\", \\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Digest_LoyaltyProgram\"]},\"Digest_User\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"UserType\"},{\"defaultValue\":\"None\",\"name\":\"UserRoleId\"},{\"name\":\"Username\"},{\"name\":\"Name\"},{\"defaultValue\":\"NA\",\"name\":\"ManagerId\"},{\"name\":\"LastName\"},{\"name\":\"FullPhotoUrl\"},{\"name\":\"Id\"},{\"name\":\"FirstName\"},{\"name\":\"SmallPhotoUrl\"}],\"object\":\"User\"}},\"Digest_LoyaltyMemberCurrency\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"BalanceBeforeReset\"},{\"name\":\"ExpirablePoints\"},{\"name\":\"Id\"},{\"name\":\"LastExpirationProcessRunDate\"},{\"name\":\"LastResetDate\"},{\"name\":\"LoyaltyMemberId\"},{\"name\":\"LoyaltyProgramCurrencyId\"},{\"name\":\"Name\"},{\"name\":\"NextResetDate\"},{\"name\":\"PointsBalance\"},{\"name\":\"TotalPointsAccrued\"},{\"name\":\"TotalPointsExpired\"},{\"name\":\"TotalPointsRedeemed\"}],\"object\":\"LoyaltyMemberCurrency\"}},\"Augment_SurveyVersion_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SurveyVersionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyVersion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"VersionNumber\",\"SurveyId\"]},\"sources\":[\"Augment_CSAT_SurveyQuestion_MaxValue_onto_SurveyQuestionresponse\",\"Augment_Survey_onto_SurveyVersion\"]},\"Augment_LoyaltyProgramMember_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"MemberId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramMember\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"EnrollmentChannel\",\"EnrollmentDate\",\"LastActivityDate\",\"MembershipEndDate\",\"MembershipNumber\",\"MemberStatus\",\"MemberType\",\"ProgramId\",\"Contact.Birthdate\",\"Contact.Name\",\"Contact.MobilePhone\",\"Account.Name\",\"LoyaltyProgram.Name\",\"Referrer.MembershipNumber\",\"Referrer.Contact.Birthdate\",\"Referrer.Contact.Name\",\"Referrer.Contact.MobilePhone\",\"AccountContact.Id\",\"MemberTenureBucket\",\"IsReferral\",\"MemberName\",\"MemberId\",\"LeadOrContactId\",\"LeadOrContactName\",\"MemberState\",\"MemberCity\",\"MemberCountry\"]},\"sources\":[\"Augment_JournalSubType_onto_TransactionJournal\",\"CE_LoyaltyProgramMember\"]},\"Augment_LoyaltyProgram_onto_LoyaltyTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyTierGroup.LoyaltyProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgram\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Status\"]},\"sources\":[\"Augment_LoyaltyTierGroup_onto_LoyaltyTier\",\"Digest_LoyaltyProgram\"]},\"Compute_OriginalPointField_LoyaltyLedger\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Points\",\"name\":\"Points\",\"precision\":10,\"saqlExpression\":\"'PointsTemp'\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Slice_OldPoints_LoyaltyLedger\"]},\"Augment_LoyaltyMemberTier_onto_Voucher\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramMemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyMemberTier\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyTier.LoyaltyTierGroup.Name\",\"LoyaltyTier.Name\"]},\"sources\":[\"Augment_LoyaltymemberCurrency_onto_Voucher\",\"Append_LoyaltyMemberTier_with_GroupMember\"]},\"Filter_TransactionJournal\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'UsageType' == \\\"Loyalty\\\"\"},\"sources\":[\"Digest_TransactionJournal\"]},\"Augment_Contact_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ContactId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Contact\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Birthdate\",\"Name\",\"MobilePhone\",\"MailingCity\",\"MailingCountry\",\"MailingState\"]},\"sources\":[\"Digest_LoyaltyProgramMember\",\"Digest_Contact\"]},\"CE_SurveySubject\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"SubjectId_CompositeKey\",\"name\":\"SubjectId_CompositeKey\",\"saqlExpression\":\"case when 'SubjectEntityType' == \\\"LoyaltyProgram\\\" && 'SurveyInvitation.ParticipantId' is null then 'SubjectId' when 'SubjectEntityType' == \\\"LoyaltyProgram\\\" && 'SurveyInvitation.ParticipantId' is not null then 'SubjectId'+'SurveyInvitation.ParticipantId' when 'SubjectEntityType' == \\\"TransactionJournal\\\" then 'SubjectId' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_Survey_onto_SurveySubject\"]},\"Filter_GroupMemberfrom_LoyaltyLedger\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\"\"},\"sources\":[\"Augment_TransactionJournal_onto_LoyaltyLedger\"]},\"Flatten_UserRole\":{\"action\":\"flatten\",\"parameters\":{\"includeSelfId\":false,\"multiField\":{\"isSystemField\":false,\"label\":\"Parents\",\"name\":\"Parents\"},\"parentField\":\"ParentRole_Id\",\"pathField\":{\"isSystemField\":false,\"label\":\"ParentPath\",\"name\":\"ParentPath\"},\"selfField\":\"UserRoleId\"},\"sources\":[\"CE_Fill_null_ParentRoleIds_with_NA\"]},\"Augment_JournalType_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"JournalTypeId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"JournalType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Filter_TransactionJournal\",\"Digest_JournalType\"]},\"Digest_Contact\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"Birthdate\"},{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"Phone\"},{\"name\":\"MobilePhone\"},{\"name\":\"MailingState\"},{\"name\":\"MailingCity\"},{\"name\":\"MailingCountry\"}],\"object\":\"Contact\"}},\"Digest_Voucher\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"LoyaltyProgramMemberId\"},{\"name\":\"TransactionJournalId\"},{\"name\":\"VoucherDefinitionId\"},{\"name\":\"EffectiveDate\"},{\"name\":\"Status\"},{\"name\":\"UseDate\"},{\"name\":\"ExpirationDate\"}],\"object\":\"Voucher\"}},\"Augment_LoyaltyProgramCurrency_onto_LoyaltyProgramTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyTierGroup.LoyaltyProgramId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyProgramCurrency\",\"rightKey\":[\"LoyaltyProgramId\"],\"rightSelect\":[\"CurrencyType\",\"NQP_Currency\",\"QP_Currency\",\"IsPrimary\"]},\"sources\":[\"Augment_LoyaltyProgram_onto_LoyaltyTier\",\"CE_LoyaltyProgramCurrency\"]},\"Filter_SurveyInvitation_with_Participant\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'ParticipantId' is not null\"},\"sources\":[\"Digest_SurveyInvitation\"]},\"Augment_SurveyQuestion_onto_SurveyQuestionChoice\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"QuestionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyQuestion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"QuestionName\",\"QuestionType\"]},\"sources\":[\"Digest_SurveyQuestionChoice\",\"Digest_SurveyQuestion\"]},\"Filter_LoyaltyLedger_AccrualReversals_for_NonGroup_Members\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TransactionJournal.JournalType.Name' == \\\"Accrual Reversal\\\" and 'TransactionJournal.JournalType.Name' != \\\"Group\\\"\"},\"sources\":[\"Augment_TransactionJournal_onto_LoyaltyLedger\"]},\"CE_Unique_UserName\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Unique User Name\",\"name\":\"UniqueUserName\",\"saqlExpression\":\"case when isDuplicate is null then 'Name' else 'Name' + \\\" (\\\" +'Username'+ \\\")\\\" end\",\"type\":\"Text\"},{\"label\":\"IsYearEndFiscal_Computed\",\"name\":\"IsYearEndFiscal_Computed\",\"saqlExpression\":\"\\\"false\\\"\",\"type\":\"Text\"},{\"label\":\"Computed_ParentID\",\"name\":\"Computed_ParentID\",\"saqlExpression\":\"'Role.ParentRoleId'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CR_Unique_User_Flag\"]},\"Augment_SurveySubject_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"InvitationId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveySubject\",\"rightKey\":[\"SurveyInvitationId\"],\"rightSelect\":[\"Id\",\"Name\",\"SubjectEntityType\",\"SubjectId\",\"SurveyId\",\"SurveyInvitation.ParticipantId\",\"Survey.Description\",\"Survey.Name\",\"Survey.SurveyType\",\"SubjectId_CompositeKey\",\"Participant.LoyaltyMemberId\",\"Participant.LoyaltyProgramMember.EnrollmentChannel\",\"Participant.LoyaltyProgramMember.MembershipNumber\",\"Participant.LoyaltyProgramMember.MemberType\",\"Participant.LoyaltyProgramMember.Contact.Name\",\"Participant.LoyaltyProgramMember.MemberTenureBucket\",\"Participant.LoyaltyProgramMember.IsReferral\",\"Participant.LoyaltyProgramMember.MemberName\",\"Participant.CreatedById\",\"Participant.User.ManagerId\",\"Participant.User.SmallPhotoUrl\",\"Participant.User.Role.Name\",\"Participant.User.Role.ParentRoleId\",\"Participant.User.Parents\",\"Participant.User.ParentPath\",\"Participant.User.UniqueUserName\",\"Participant.User.Computed_ParentID\",\"LoyaltyProgramTier.Name\",\"LoyaltyProgramTier.LoyaltyTierGroup.Name\",\"LoyaltyProgramTier.LoyaltyProgram.Name\",\"LoyaltyProgramTier.LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramTier.LoyaltyProgramCurrency.QP_Currency\",\"Participant.LoyaltyProgramMember.MemberCity\",\"Participant.LoyaltyProgramMember.MemberState\",\"Participant.LoyaltyProgramMember.MemberCountry\",\"Participant.TransactionLocation\",\"Participant.Establishment\"]},\"sources\":[\"CR_SurveyQuestionResponse\",\"Update_SurveySubject_with_TransactionJournal\"]},\"Register_SurveyQuestionResponse_with_TransactionJournalRecords\":{\"action\":\"register\",\"parameters\":{\"label\":\"SurveyQuestionResponse_with_TransactionJournalRecords\",\"name\":\"SurveyQuestionResponse_with_TransactionJournalRecords\",\"rowLevelSecurityFilter\":\"'SurveySubject.Participant.CreatedById' == \\\"$User.Id\\\" || 'SurveySubject.Participant.User.Parents' == \\\"$User.UserRoleId\\\"\"},\"sources\":[\"Filter_SurveyQuestionResponse_with_TransactionJournalRecords\"]},\"Register_LoyaltyLedger\":{\"action\":\"register\",\"parameters\":{\"label\":\"LoyaltyLedger\",\"name\":\"LoyaltyLedger\"},\"sources\":[\"CE_LoyaltyLedger\"]},\"CE_LoyaltyLedger\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"TransactionType_w_GroupMember\",\"name\":\"TransactionType_w_GroupMember\",\"saqlExpression\":\"case \\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Credit\\\" then \\n    case \\n        when 'TransactionJournal.JournalType.Name' == \\\"Accrual\\\" then \\\"Accrual\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Manual Points Adjustment\\\" then \\\"AdjustedPoints_Positive\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Redemption Reversal\\\" then \\\"RedemptionReversal\\\" \\n    end \\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Debit\\\" then \\n    case \\n        when 'TransactionJournal.JournalType.Name' == \\\"Redemption\\\" then \\\"Redemption\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Manual Points Adjustment\\\" then \\\"AdjustedPoints_Negative\\\" \\n        when 'TransactionJournal.JournalType.Name' == \\\"Accrual Reversal\\\" then \\\"AccrualReversal\\\"\\n    end\\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Transfer\\\" && 'TransactionJournal.JournalType.Name' == \\\"Accrual\\\" then \\n    \\\"Accrual_Transfer\\\"\\nwhen 'TransactionJournal.Status' == \\\"Processed\\\" && 'EventType' == \\\"Expiry\\\" then \\n    \\\"Expired\\\"\\nend\",\"type\":\"Text\"},{\"label\":\"TransactionType\",\"name\":\"TransactionType\",\"saqlExpression\":\"case when 'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'TransactionType_w_GroupMember' == \\\"Accrual\\\" then \\\"Accrual\\\"+\\\"_Group\\\" else 'TransactionType_w_GroupMember' end\",\"type\":\"Text\"},{\"label\":\"Total Accrued Points\",\"name\":\"Total_Accrued_Points\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Accrual\\\", \\\"AdjustedPoints_Positive\\\"] then 'Points'\\n    when 'TransactionType' == \\\"AdjustedPoints_Negative\\\" then -'Points'\\nend\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Points_Value\",\"name\":\"Points_Amount\",\"precision\":10,\"saqlExpression\":\"Points*'LoyaltyProgramCurrency.CostperUnit'\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Total_Accrued_Points_Amount\",\"name\":\"Total_Accrued_Points_Amount\",\"precision\":10,\"saqlExpression\":\"case \\n    when 'TransactionType' in [\\\"Accrual\\\", \\\"AdjustedPoints_Positive\\\"] then 'Points_Amount'\\n    when 'TransactionType' == \\\"AdjustedPoints_Negative\\\" then -'Points_Amount'\\nend\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"ChangeReasonType\",\"name\":\"ChangeReasonType\",\"saqlExpression\":\"'TransactionJournal.JournalReason'\",\"type\":\"Text\"},{\"label\":\"IncludeInManualActions\",\"name\":\"IncludeInManualActions\",\"saqlExpression\":\"case when 'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\" && 'TransactionType' in [\\\"RedemptionReversal\\\"] then \\\"True\\\"\\nwhen 'TransactionJournal.LoyaltyProgramMember.MemberType' != \\\"Group\\\" && 'TransactionType' in [\\\"AccrualReversal\\\", \\\"AdjustedPoints_Positive\\\", \\\"AdjustedPoints_Negative\\\", \\\"RedemptionReversal\\\"] then \\\"True\\\" else \\\"False\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_User_onto_LoyaltyLedger\"]},\"Augment_RelatedLoyaltyLedger_onto_GroupMember_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"TransactionJournal.RelatedJournalId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RelatedTransactionJournal1\",\"rightKey\":[\"TransactionJournalId\"],\"rightSelect\":[\"TransactionJournal.RelatedJournalId\"]},\"sources\":[\"Filter_GroupMemberfrom_LoyaltyLedger\",\"Augment_TransactionJournal_onto_LoyaltyLedger\"]},\"CE_GroupTier_Name\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Name\",\"name\":\"Name\",\"saqlExpression\":\"\\\"Tier Not Assigned\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Slice_GroupTierName\"]},\"Digest_UserRole\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"DeveloperName\"},{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"ParentRoleId\"}],\"object\":\"UserRole\"}},\"Augment_TransactionJournal_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SubjectId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Participant\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CreatedById\",\"MemberId\",\"LoyaltyProgramMember.EnrollmentChannel\",\"LoyaltyProgramMember.MemberType\",\"LoyaltyProgramMember.Contact.Name\",\"LoyaltyProgramMember.LoyaltyProgram.Name\",\"LoyaltyProgramMember.MemberTenureBucket\",\"LoyaltyProgramMember.IsReferral\",\"LoyaltyProgramMember.MemberName\",\"User.ManagerId\",\"User.SmallPhotoUrl\",\"User.Role.Name\",\"User.Role.ParentRoleId\",\"User.Parents\",\"User.ParentPath\",\"User.UniqueUserName\",\"User.Computed_ParentID\",\"LoyaltyMemberCurrency.LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyMemberCurrency.LoyaltyProgramCurrency.QP_Currency\",\"LoyaltyMemberTier.LoyaltyTier.Name\",\"LoyaltyMemberTier.LoyaltyTier.LoyaltyTierGroup.Name\",\"LoyaltyProgramMember.MemberCity\",\"LoyaltyProgramMember.MemberState\",\"LoyaltyProgramMember.MemberCountry\",\"TransactionLocation\",\"Establishment\"]},\"sources\":[\"Filter_SurveySubject_with_TransactionJournal\",\"Augment_LoyaltyMemberTier_onto_TransactionJournal\"]},\"Augment_LoyaltyTier_onto_LoyaltyMemberTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyTierId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyTier\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"SequenceNumber\",\"LoyaltyTierGroup.Name\",\"LoyaltyTierGroup.IsPrimary\"]},\"sources\":[\"Digest_LoyaltyMemberTier\",\"Augment_LoyaltyTierGroup_onto_LoyaltyTier\"]},\"Compute_PointField_LoyaltyLedger\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"PointsTemp\",\"name\":\"PointsTemp\",\"precision\":10,\"saqlExpression\":\"case when 'TransactionJournal.JournalType.Name' in [\\\"Accrual Reversal\\\", \\\"Manual Points Adjustment\\\"] and 'TransactionJournal.LoyaltyProgramMember.MemberType' != \\\"Group\\\" then  (coalesce('Points',0)+coalesce('GroupPoints.Points',0)) when 'TransactionJournal.JournalType.Name' in [\\\"Accrual Reversal\\\", \\\"Manual Points Adjustment\\\"] and 'TransactionJournal.LoyaltyProgramMember.MemberType' == \\\"Group\\\"  then null else 'Points' end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_FinalRelatedTransactionJournal_onto_LoyaltyLedger\"]},\"Register_LoyaltyProgramTier\":{\"action\":\"register\",\"parameters\":{\"label\":\"LoyaltyProgramTier\",\"name\":\"LoyaltyProgramTier\"},\"sources\":[\"Augment_LoyaltyProgramCurrency_onto_LoyaltyProgramTier\"]},\"Augment_Account_onto_LoyaltyProgramPartner\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyPartnerId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Partner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Type\"]},\"sources\":[\"Digest_LoyaltyProgramPartner\",\"Digest_Account\"]},\"CR_SurveyQuestionResponse\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"previous()\",\"sourceField\":\"Question_Response_Id\"},\"label\":\"FirstResponseValue\",\"name\":\"FirstResponseValue\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"SurveyResponse.CompletionDateTime\"}],\"partitionBy\":[\"Question_Response_Id\"]},\"sources\":[\"Append_SurveyQuestionResponse_with_Dummy\"]},\"Digest_TransactionJournal\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActivityDate\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"Id\"},{\"name\":\"JournalDate\"},{\"name\":\"JournalSubTypeId\"},{\"name\":\"JournalTypeId\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"MemberId\"},{\"name\":\"Status\"},{\"name\":\"UsageType\"},{\"name\":\"Industry\"},{\"name\":\"Brand\"},{\"name\":\"Channel\"},{\"name\":\"IsDeleted\"},{\"name\":\"PartnerId\"},{\"name\":\"PaymentMethod\"},{\"name\":\"ProductCategoryId\"},{\"name\":\"ProductId\"},{\"name\":\"Quantity\"},{\"name\":\"QuantityUnitOfMeasureId\"},{\"name\":\"RelatedJournalId\"},{\"name\":\"TransactionAmount\"},{\"name\":\"TransactionLocation\"},{\"name\":\"Establishment\"},{\"name\":\"JournalReason\"}],\"object\":\"TransactionJournal\"}},\"Augment_UserRole_onto_User\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"UserRoleId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Role\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"ParentRoleId\",\"Name\"]},\"sources\":[\"Digest_User\",\"Digest_UserRole\"]},\"Digest_LoyaltyTierGroup\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Description\"},{\"name\":\"IsActive\"},{\"name\":\"LoyaltyProgramId\"},{\"name\":\"Name\"},{\"name\":\"TierModel\"},{\"name\":\"TierPeriodQuantity\"},{\"name\":\"TierPeriodUnit\"},{\"name\":\"QpResetDate\"},{\"name\":\"QpResetFrequency\"},{\"name\":\"QpResetPeriod\"},{\"name\":\"IsPrimary\"}],\"object\":\"LoyaltyTierGroup\"}},\"Augment_User_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"CreatedById\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"User\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Username\",\"FullPhotoUrl\",\"UniqueUserName\",\"SmallPhotoUrl\",\"Computed_ParentID\",\"ParentPath\",\"Parents\",\"Role.ParentRoleId\",\"Role.Name\",\"ManagerId\"]},\"sources\":[\"Augment_LoyaltyMemberTier_onto_LoyaltyLedger\",\"CE_Unique_UserName\"]},\"Augment_LoyaltyProgramCurrency_onto_LoyaltyLedger\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyProgramCurrencyId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramCurrency\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CurrencyType\",\"NQP_Currency\",\"QP_Currency\",\"CostperUnit\"]},\"sources\":[\"Compute_OriginalPointField_LoyaltyLedger\",\"CE_LoyaltyProgramCurrency\"]},\"Digest_LoyaltyTier\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Description\"},{\"name\":\"LoyaltyTierGroupId\"},{\"name\":\"Name\"},{\"name\":\"SequenceNumber\"}],\"object\":\"LoyaltyTier\"}},\"CE_Fill_null_ParentRoleIds_with_NA\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"ParentRole_Id\",\"name\":\"ParentRole_Id\",\"saqlExpression\":\"case when 'Role.ParentRoleId' is null then \\\"NA\\\" else 'Role.ParentRoleId' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_UserRole_onto_User\"]},\"Augment_LoyaltyMemberTier_onto_LoyaltyMemberCurrency\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyMemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"MemberTier\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyTier.Name\",\"LoyaltyTier.LoyaltyTierGroup.Name\"]},\"sources\":[\"CE_LoyaltyMemberCurrency\",\"Augment_LoyaltyMemberCurrency_onto_LoyaltyMemberTier\"]},\"Augment_SurveyResponse_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ResponseId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyResponse\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CompletionDateTime\",\"Name\",\"Status\"]},\"sources\":[\"Augment_SurveyQuestion_onto_SurveyQuestionResponse\",\"Digest_SurveyResponse\"]},\"Update_SurveySubject_with_TransactionJournal\":{\"action\":\"update\",\"parameters\":{\"leftKey\":[\"SubjectId_CompositeKey\"],\"rightKey\":[\"SubjectId_CompositeKey\"],\"updateColumns\":{\"LoyaltyProgramTier.Name\":\"Participant.LoyaltyMemberTier.LoyaltyTier.Name\",\"Participant.LoyaltyMemberId\":\"Participant.MemberId\",\"LoyaltyProgramTier.LoyaltyProgram.Name\":\"Participant.LoyaltyProgramMember.LoyaltyProgram.Name\",\"LoyaltyProgramTier.LoyaltyProgramCurrency.NQP_Currency\":\"Participant.LoyaltyMemberCurrency.LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramTier.LoyaltyTierGroup.Name\":\"Participant.LoyaltyMemberTier.LoyaltyTier.LoyaltyTierGroup.Name\",\"LoyaltyProgramTier.LoyaltyProgramCurrency.QP_Currency\":\"Participant.LoyaltyMemberCurrency.LoyaltyProgramCurrency.QP_Currency\"}},\"sources\":[\"Update_SurveySubject_with_Participant_Details\",\"Augment_TransactionJournal_onto_SurveySubject\"]},\"Append_SurveySubject_All\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Augment_Participant_onto_SurveySubject\",\"Augment_TransactionJournal_onto_SurveySubject\",\"Augment_LoyaltyProgramTier_onto_SurveySubject\"]},\"Digest_SurveySubject\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"Name\"},{\"name\":\"ParentId\"},{\"name\":\"SubjectEntityType\"},{\"name\":\"SubjectId\"},{\"name\":\"SurveyId\"},{\"name\":\"SurveyInvitationId\"},{\"name\":\"SurveyResponseId\"}],\"object\":\"SurveySubject\"}},\"Digest_SurveyResponse\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CompletionDateTime\"},{\"name\":\"CreatedDate\"},{\"name\":\"Id\"},{\"name\":\"InterviewGuid\"},{\"name\":\"InterviewId\"},{\"name\":\"InvitationId\"},{\"name\":\"IpAddress\"},{\"name\":\"IsDeleted\"},{\"name\":\"Language\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"Status\"},{\"name\":\"SubmitterId\"},{\"name\":\"SurveyId\"},{\"name\":\"SurveyVersionId\"}],\"object\":\"SurveyResponse\"}},\"Register_TransactionJournal\":{\"action\":\"register\",\"parameters\":{\"label\":\"TransactionJournal\",\"name\":\"TransactionJournal\"},\"sources\":[\"Augment_LoyaltyMemberTier_onto_TransactionJournal\"]},\"CE_LoyaltyProgramCurrency\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"NQP Currency\",\"name\":\"NQP_Currency\",\"saqlExpression\":\"case when 'CurrencyType' == \\\"NonQualifying\\\" then 'Name' end\",\"type\":\"Text\"},{\"label\":\"QP Currency\",\"name\":\"QP_Currency\",\"saqlExpression\":\"case when 'CurrencyType' == \\\"Qualifying\\\" then 'Name' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Digest_LoyaltyProgramCurrency\"]},\"Augment_LoyaltyProgramPartner_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"PartnerId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgramPartner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Partner.Name\",\"Partner.Type\",\"PartnerCategory\",\"PartnerIndustry\",\"PartnerType\"]},\"sources\":[\"Augment_LoyaltyProgramMember_onto_TransactionJournal\",\"Augment_Account_onto_LoyaltyProgramPartner\"]},\"Digest_SurveyInvitation\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"InvitationLink\"},{\"name\":\"InviteExpiryDateTime\"},{\"name\":\"IsDefault\"},{\"name\":\"Name\"},{\"name\":\"ParticipantId\"},{\"name\":\"ResponseStatus\"},{\"name\":\"SurveyId\"},{\"name\":\"IsDeleted\"}],\"object\":\"SurveyInvitation\"}},\"Digest_JournalType\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Description\"},{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"JournalType\"}},\"CR_TransactionJournal_GetFirstTwoAccrualDatesByProgramMember\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"ActivityDate\"},\"label\":\"FirstAccrualDate\",\"name\":\"FirstAccrualDate\"},{\"expression\":{\"offset\":\"next()\",\"sourceField\":\"ActivityDate\"},\"label\":\"SecondAccrualDate\",\"name\":\"SecondAccrualDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"ActivityDate\"}],\"partitionBy\":[\"MemberId\"]},\"sources\":[\"Filter_TransactionJournal_GetAccrualDatesByProgramMember\"]},\"Augment_VoucherDefinition_onto_Voucher\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"VoucherDefinitionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"VoucherDefinition\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CostPerVoucher\",\"EffectiveDate\",\"ExpirationDate\",\"Type\"]},\"sources\":[\"Digest_Voucher\",\"Digest_VoucherDefinition\"]},\"Digest_LoyaltyLedger\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ActivityDate\"},{\"name\":\"AdditionalNotes\"},{\"name\":\"Correlation\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"EventType\"},{\"name\":\"ExpiryDate\"},{\"name\":\"Flow\"},{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"LoyaltyProgramCurrencyId\"},{\"name\":\"LoyaltyProgramMemberId\"},{\"name\":\"Points\"},{\"name\":\"TransactionJournalId\"},{\"name\":\"SystemModstamp\"}],\"object\":\"LoyaltyLedger\"}},\"Augment_User_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"CreatedById\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"User\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"SmallPhotoUrl\",\"UniqueUserName\",\"Computed_ParentID\",\"ManagerId\",\"Parents\",\"ParentPath\",\"Role.Name\",\"Role.ParentRoleId\"]},\"sources\":[\"Augment_ProductCategory_onto_TransactionJournal\",\"CE_Unique_UserName\"]},\"Augment_ProgramMemberFirstTwoAccrualDates_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"TransactionJournal\",\"rightKey\":[\"MemberId\"],\"rightSelect\":[\"FirstAccrualDate\",\"SecondAccrualDate\"]},\"sources\":[\"Augment_Referrer_onto_LoyaltyProgramMember\",\"CR_TransactionJournal_GetFirstTwoAccrualDatesByProgramMember\"]},\"Filter_SurveyQuestionChoice_with_RatingQuestion\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'SurveyQuestion.QuestionType' == \\\"Rating\\\"\"},\"sources\":[\"Augment_SurveyQuestion_onto_SurveyQuestionChoice\"]},\"Digest_Product\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Description\"},{\"name\":\"Family\"},{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"ProductCode\"}],\"object\":\"Product2\"}},\"Filter_LoyaltyLedger1\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'TransactionType' in [\\\"AdjustedPoints_Positive\\\", \\\"AdjustedPoints_Negative\\\", \\\"RedemptionReversal\\\", \\\"AccrualReversal\\\"]\"},\"sources\":[\"CE_LoyaltyLedger\"]},\"Digest_SurveyQuestion\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"DeveloperName\"},{\"name\":\"Id\"},{\"name\":\"IsDeleted\"},{\"name\":\"IsDeprecated\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"QuestionName\"},{\"name\":\"QuestionType\"},{\"name\":\"SurveyPageId\"},{\"name\":\"SurveyVersionId\"},{\"name\":\"SystemModstamp\"}],\"object\":\"SurveyQuestion\"}},\"Augment_Contact_with_Account_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"AccountContact\",\"rightKey\":[\"AccountId\"],\"rightSelect\":[\"Id\",\"Name\"]},\"sources\":[\"Augment_ProgramMemberFirstTwoAccrualDates_onto_LoyaltyProgramMember\",\"Augment_Account_onto_Contact\"]},\"Augment_Dummy_Self\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Question_Response_Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyResponse\",\"rightKey\":[\"Question_Response_Id\"],\"rightSelect\":[\"CompletionDateTime\"]},\"sources\":[\"Filter_Dummy\",\"Filter_Dummy\"]},\"Augment_LoyaltyTierGroup_onto_LoyaltyTier\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LoyaltyTierGroupId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyTierGroup\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"LoyaltyProgramId\",\"Name\",\"IsPrimary\"]},\"sources\":[\"Digest_LoyaltyTier\",\"Digest_LoyaltyTierGroup\"]},\"Augment_Account_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Account\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"BillingCity\",\"BillingCountry\",\"BillingState\"]},\"sources\":[\"Augment_Contact_onto_LoyaltyProgramMember\",\"Digest_Account\"]},\"Append_SurveySubject\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Augment_SurveyInvitation_withParticipant_onto_SurveySubject\",\"Augment_SurveyInvitation_woParticipant_onto_SurveySubject\"]},\"Compute_FinalRelatedTransactionJournal_LoyaltyLedger\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"RelatedTransactionJournal\",\"name\":\"RelatedTransactionJournal\",\"saqlExpression\":\"case when 'TransactionJournal.JournalType.Name' == \\\"Accrual Reversal\\\" then 'RelatedTransactionJournal2.TransactionJournalId' when 'TransactionJournal.JournalType.Name' == \\\"Manual Points Adjustment\\\" then 'TransactionJournal.RelatedJournalId' else \\\"null\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_AccrualReversal_onto_Related1_LoyaltyLedger\"]},\"Augment_SurveyInvitation_withParticipant_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ParentId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyInvitation\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"ParticipantId\"]},\"sources\":[\"Digest_SurveySubject\",\"Filter_SurveyInvitation_with_Participant\"]},\"CE_SurveyQuestionResponse_Final\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"NPS_Response_Bucket\",\"name\":\"NPS_Response_Bucket\",\"saqlExpression\":\"case \\n    when 'NumberValue' >= 0 and 'NumberValue' <= 6 then \\\"Detractors\\\"\\nwhen 'NumberValue' >= 7  and 'NumberValue' <= 8 then \\\"Passives\\\" \\n    when 'NumberValue' >= 9  and 'NumberValue' <= 10 then \\\"Promoters\\\" \\n    end\",\"type\":\"Text\"},{\"defaultValue\":\"5\",\"label\":\"Scale\",\"name\":\"Scale\",\"precision\":2,\"saqlExpression\":\"5\",\"scale\":1,\"type\":\"Numeric\"},{\"label\":\"IsDuplicateResponse\",\"name\":\"IsDuplicateResponse\",\"saqlExpression\":\"case when 'FirstResponseValue' is null then \\\"False\\\" else \\\"True\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_TransactionType_onto_SurveyQuestionResponse\"]},\"Augment_Participant_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SubjectId\",\"SurveyInvitation.ParticipantId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"Participant\",\"rightKey\":[\"LoyaltyProgramMember.ProgramId\",\"LoyaltyProgramMember.ContactId\"],\"rightSelect\":[\"LoyaltyMemberId\",\"LoyaltyTier.Name\",\"LoyaltyTier.LoyaltyTierGroup.Name\",\"LoyaltyProgramMember.EnrollmentChannel\",\"LoyaltyProgramMember.MembershipNumber\",\"LoyaltyProgramMember.MemberStatus\",\"LoyaltyProgramMember.MemberType\",\"LoyaltyProgramMember.ProgramId\",\"LoyaltyProgramMember.Contact.Name\",\"LoyaltyProgramMember.LoyaltyProgram.Name\",\"LoyaltyProgramMember.MemberTenureBucket\",\"LoyaltyProgramMember.IsReferral\",\"LoyaltyProgramMember.MemberName\",\"LoyaltyProgramMember.MemberId\",\"LoyaltyMemberCurrency.LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyMemberCurrency.LoyaltyProgramCurrency.QP_Currency\",\"LoyaltyProgramMember.MemberCity\",\"LoyaltyProgramMember.MemberState\",\"LoyaltyProgramMember.MemberCountry\"]},\"sources\":[\"Filter_SurveySubject_with_Program_and_Participant\",\"Augment_LoyaltyMemberCurrency_onto_LoyaltyMemberTier\"]},\"Digest_LoyaltyMemberTier\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"EffectiveDate\"},{\"name\":\"Id\"},{\"name\":\"LoyaltyMemberId\"},{\"name\":\"LoyaltyTierGroupId\"},{\"name\":\"LoyaltyTierId\"},{\"name\":\"Name\"},{\"name\":\"ReasonForChange\"},{\"name\":\"TierExpirationDate\"},{\"name\":\"ChangeReasonType\"}],\"object\":\"LoyaltyMemberTier\"}},\"Register_SurveyQuestionResponse\":{\"action\":\"register\",\"parameters\":{\"label\":\"SurveyQuestionResponse\",\"name\":\"SurveyQuestionResponse\"},\"sources\":[\"CE_SurveyQuestionResponse_Final\"]},\"Register_LoyaltyMemberTier\":{\"action\":\"register\",\"parameters\":{\"label\":\"LoyaltyMemberTier\",\"name\":\"LoyaltyMemberTier\"},\"sources\":[\"Augment_LoyaltyMemberCurrency_onto_LoyaltyMemberTier\"]},\"Filter_Dummy\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CR_Computed_Dummy == \\\"Dummy\\\"\"},\"sources\":[\"CR_Dummy\"]},\"Augment_SurveyQuestion_onto_SurveyQuestionResponse\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"QuestionId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"SurveyQuestion\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"QuestionType\",\"QuestionName\",\"Name\"]},\"sources\":[\"Digest_SurveyQuestionResponse\",\"Digest_SurveyQuestion\"]},\"Augment_LoyaltyProgramTier_onto_SurveySubject\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"SubjectId_CompositeKey\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyProgramTier\",\"rightKey\":[\"LoyaltyTierGroup.LoyaltyProgramId\"],\"rightSelect\":[\"LoyaltyProgram.Name\",\"LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramCurrency.QP_Currency\",\"LoyaltyProgramCurrency.CurrencyType\",\"LoyaltyTierGroup.Name\",\"Name\"]},\"sources\":[\"Filter_SurveySubject_with_LoyaltyProgram\",\"Augment_LoyaltyProgramCurrency_onto_LoyaltyProgramTier\"]},\"Augment_LoyaltyMemberCurrency_onto_TransactionJournal\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"MemberId\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"LoyaltyMemberCurrency\",\"rightKey\":[\"LoyaltyMemberId\"],\"rightSelect\":[\"LoyaltyProgramCurrency.NQP_Currency\",\"LoyaltyProgramCurrency.QP_Currency\",\"LoyaltyProgramMember.AccountContact.Id\"]},\"sources\":[\"CE_TransactionJournal\",\"Augment_LoyaltyProgramCurrency_onto_LoyaltyMemberCurrency\"]},\"Filter_LoyaltyProgramMember_Group\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"MemberType == \\\"Group\\\"\"},\"sources\":[\"Digest_LoyaltyProgramMember\"]},\"CE_LoyaltyProgramMember\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Member Tenure\",\"name\":\"MemberTenureBucket\",\"saqlExpression\":\"case  when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"30 days ago\\\"..\\\"current day\\\"] then \\\"1.< 1 month\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"90 days ago\\\"..\\\"31 days ago\\\"] then \\\"2.1-3 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"180 days ago\\\"..\\\"91 days ago\\\"] then \\\"3.3-6 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"270 days ago\\\"..\\\"181 days ago\\\"] then \\\"4.6-9 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"1 day ago - 1 year\\\"..\\\"271 days ago\\\"] then \\\"5.9-12 months\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"1 day ago - 2 years\\\"..\\\"current day - 1 year\\\"] then \\\"6.1-2 years\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [\\\"1 day ago - 5 years\\\"..\\\"current day - 2 years\\\"] then \\\"7.2-5 years\\\" when date('EnrollmentDate_Year', 'EnrollmentDate_Month', 'EnrollmentDate_Day') in [..\\\"current day - 5 years\\\"] then \\\"8.5+ years\\\" else \\\"9.NA\\\" end\",\"type\":\"Text\"},{\"label\":\"IsReferral\",\"name\":\"IsReferral\",\"saqlExpression\":\"case when 'ReferredById' is not null then \\\"Yes\\\" else \\\"No\\\" end\",\"type\":\"Text\"},{\"defaultValue\":\"Not Available\",\"label\":\"MemberName\",\"name\":\"MemberName\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.Name' when 'MemberType' == \\\"Corporate\\\" then 'Account.Name' when 'MemberType' == \\\"Group\\\" then coalesce('Contact.Name', 'Account.Name', \\\"Not Available\\\") end\",\"type\":\"Text\"},{\"label\":\"MemberId\",\"name\":\"MemberId\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'ContactId' when 'MemberType' == \\\"Corporate\\\" then 'AccountId' when 'MemberType' == \\\"Group\\\" then coalesce('ContactId', 'AccountId', \\\"NA\\\") end\",\"type\":\"Text\"},{\"label\":\"LeadOrContactId\",\"name\":\"LeadOrContactId\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'ContactId' when 'MemberType' == \\\"Corporate\\\" then 'AccountContact.Id'  when 'MemberType' == \\\"Group\\\" then coalesce('ContactId', 'AccountContact.Id', \\\"NA\\\") end\",\"type\":\"Text\"},{\"label\":\"LeadOrContactName\",\"name\":\"LeadOrContactName\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.Name' when 'MemberType' == \\\"Corporate\\\" then 'AccountContact.Name' when 'MemberType' == \\\"Group\\\" then coalesce('Contact.Name', 'AccountContact.Name', \\\"NA\\\") end\",\"type\":\"Text\"},{\"defaultValue\":\"City Not Available\",\"label\":\"MemberCity\",\"name\":\"MemberCity\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.MailingCity' when 'MemberType' == \\\"Corporate\\\" then 'Account.BillingCity' when 'MemberType' == \\\"Group\\\" then coalesce('Contact.MailingCity', 'Account.BillingCity', \\\"City Not Available\\\") end\",\"type\":\"Text\"},{\"defaultValue\":\"State Not Available\",\"label\":\"MemberState\",\"name\":\"MemberState\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.MailingState' when 'MemberType' == \\\"Corporate\\\" then 'Account.BillingState' when 'MemberType' == \\\"Group\\\" then coalesce('Contact.MailingState', 'Account.BillingState', \\\"State Not Available\\\") end\",\"type\":\"Text\"},{\"defaultValue\":\"Country Not Available\",\"label\":\"MemberCountry\",\"name\":\"MemberCountry\",\"saqlExpression\":\"case when 'MemberType' == \\\"Individual\\\" then 'Contact.MailingCountry' when 'MemberType' == \\\"Corporate\\\" then 'Account.BillingCountry' when 'MemberType' == \\\"Group\\\" then coalesce('Contact.MailingCountry', 'Account.BillingCountry', \\\"Country Not Available\\\") end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_Contact_with_Account_onto_LoyaltyProgramMember\"]},\"Append_SurveyQuestionResponse_with_Dummy\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Augment_Dummy_Self\",\"CE_SurveyQuestionResponse\"]},\"Filter_SurveyInvitation_without_Participant\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'ParticipantId' is null\"},\"sources\":[\"Digest_SurveyInvitation\"]},\"Augment_LoyaltyProgram_onto_LoyaltyProgramMember\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ProgramId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LoyaltyProgram\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Augment_Account_onto_LoyaltyProgramMember\",\"Digest_LoyaltyProgram\"]},\"Digest_SurveyQuestionChoice\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"QuestionId\"}],\"object\":\"SurveyQuestionChoice\"}}}}",null]